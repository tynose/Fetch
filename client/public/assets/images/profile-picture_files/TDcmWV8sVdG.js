if (self.CavalryLogger) { CavalryLogger.start_js(["1Lezr"]); }

__d("EventPlanExperiment",["EventRemindersGating","QE2Logger"],(function(a,b,c,d,e,f){"use strict";var g="event_plan_entry_point_nux";a={shouldShowEntryPointNuxWithExposure:function(){b("QE2Logger").logExposureForUser(g);return b("EventRemindersGating").shouldShowEntryPointNux},shouldShowReminderExtension:function(){b("QE2Logger").logExposureForUser("omni_m_experiments_reminders");return b("EventRemindersGating").omniMAlwaysShowReminderExtension}};e.exports=a}),null);
__d("ChatAnimatedGifs",["URI"],(function(a,b,c,d,e,f){__p&&__p();var g={shouldHideBody:function(a){__p&&__p();if(!a.has_attachment)return!1;for(var b=0;b<a.attachments.length;b++){var c=a.attachments[b];if(c.preview_url){c=g.getRawUrlFromSafeUrl(c.preview_url);if(a.body==c)return!0}}return!1},getRawUrlFromSafeUrl:function(a){return new(b("URI"))(a).getQueryData().url}};e.exports=g}),null);
__d("ChatBubble.react",["cx","BootloadedComponent.react","DOMDimensions","EmojiOnlyMessage.react","ErrorBoundary.react","JSResource","MercuryConfig","MercuryMessageBody.react","MercuryMessageRenderLocations","MessageReplyPermissions","MessengerMathUtils","MessengerSupportedEmojiUtils","React","ReactDOM","joinClasses","messengerCustomColorUtils"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;var h=2;c=b("React").createClass({displayName:"ChatBubble",_boxWidth:0,_repliedToMessageRef:null,propTypes:{attachments:a.node,body:a.string,className:a.string,customColor:a.string,customLike:a.object,isEmojiLike:a.bool,isFromViewer:a.bool,maxWidth:a.number.isRequired,message:a.object,metaRanges:a.array,onReplyToMessage:a.func,ranges:a.array,threadCustomColor:a.string,threadID:a.string},getInitialState:function(){return{emojis:void 0,bubbleWidth:null}},componentDidMount:function(){if(this.props.attachments&&!this.props.isEmojiLike)return;if(!this.props.emojis){var a=this.props.body||"";a=b("MessengerSupportedEmojiUtils").getEmojiOnlyContents(a);a&&a.length&&this.setState({emojis:a})}this._restyleBubble(this.props)},componentDidUpdate:function(a){(a.maxWidth!==this.props.maxWidth||a.body!==this.props.body||!a.attachments&&this.props.attachments)&&this._restyleBubble(a)},render:function(){__p&&__p();var a=this.props,c=a.attachments,d=a.body;d=d===void 0?"":d;var e=a.className,f=a.maxWidth;a=babelHelpers.objectWithoutPropertiesLoose(a,["attachments","body","className","maxWidth"]);a=Object.assign({},a);delete a.customColor;delete a.customLike;delete a.isEmojiLike;delete a.isFromViewer;delete a.message;delete a.metaRanges;delete a.ranges;delete a.threadCustomColor;delete a.threadID;return b("React").createElement("div",babelHelpers["extends"]({},a,{className:b("joinClasses")("_5w1r"+(this.state.emojis?"":" _3_om")+(this.state.emojis?" _31xx":"")+(((a=this.props)==null?void 0:(a=a.message)==null?void 0:(a=a.replied_to_message)==null?void 0:(a=a.message)==null?void 0:a.body)&&!b("MercuryConfig").SM3BD?" _1vmy":""),e),ref:"bubble",style:{maxWidth:f,width:this.state.emojis?null:this.state.bubbleWidth,wordWrap:d.length>=15?"break-word":"inherit"}}),b("React").createElement("div",{className:"_4gx_",ref:"inner"},this._renderContent(),c))},_renderContent:function(){if(!this.props.body||this.props.isEmojiLike)return null;var a={},c=null;this.state.emojis?c=b("React").createElement(b("EmojiOnlyMessage.react"),{contents:this.state.emojis}):(c=b("React").createElement(b("MercuryMessageBody.react"),{body:this.props.body,ranges:this.props.ranges,metaRanges:this.props.metaRanges,threadID:this.props.threadID,customLike:this.props.customLike,threadCustomColor:this.props.threadCustomColor,isFromViewer:this.props.isFromViewer,renderLocation:b("MercuryMessageRenderLocations").CHAT}),this.props.customColor&&(a=b("messengerCustomColorUtils").customBubbleStyle(this.props.customColor,a)));var d=this.props.message&&this.props.message.replied_to_message&&b("MessageReplyPermissions").bubbleContainsRepliedToMessage(this.props.message.replied_to_message,!!this.state.emojis)?b("React").createElement(b("ErrorBoundary.react"),null,b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("RepliedToMessageContent.react").__setRef("ChatBubble.react"),bootloadPlaceholder:b("React").createElement("div",null),isFromViewer:this.props.isFromViewer,isLinkified:!0,isMessengerUI:!1,repliedToMessageData:this.props.message&&this.props.message.replied_to_message,threadID:this.props.threadID,ref:this._setRepliedToMessageRef,replyInOneBubble:!0})):null;return b("React").createElement("div",{className:"_1aa6"+(this.state.emojis?" _31xy":"")+(this.props.message&&this.props.message.isSelected?" _1yok":"")+(d?" _6e7o":""),ref:"contentWrapper",style:a},d,d?"\n":null,b("React").createElement("span",{className:"_5yl5",ref:"content"},c))},_restyleBubble:function(a){__p&&__p();if(this.props.attachments||this.props.body!=null&&b("MessengerMathUtils").isMathBlock(this.props.body.trim())){this.setState({bubbleWidth:null});return}var c=b("ReactDOM").findDOMNode(this.refs.bubble);if(a.maxWidth!==this.props.maxWidth||b("DOMDimensions").getElementDimensions(c).width>this.props.maxWidth){a=this.props.maxWidth;this.setState({bubbleWidth:a},this._shrinkBubble);return}this._shrinkBubble()},_shrinkBubble:function(){__p&&__p();var a=b("ReactDOM").findDOMNode(this.refs.bubble);if(!a)return;a=b("DOMDimensions").getElementDimensions(a).width;var c=b("ReactDOM").findDOMNode(this.refs.content),d=b("DOMDimensions").getElementDimensions(c).width;if(this._repliedToMessageRef){var e=b("ReactDOM").findDOMNode(this._repliedToMessageRef);e=b("DOMDimensions").getElementDimensions(e).width;d=Math.max(e,d)}e=c?d+b("DOMDimensions").measureElementBox(b("ReactDOM").findDOMNode(this.refs.contentWrapper)||{},"width",!0,!1,!1):0;c=e+h;d>0&&c<this.props.maxWidth&&a-c-this.getBoxWidth()>0&&this.setState({bubbleWidth:c})},contentWraps:function(){var a=b("ReactDOM").findDOMNode(this.refs.content);if(!a)return!1;var c=a.getClientRects();a=b("DOMDimensions").getElementDimensions(a).height;return c&&c.length>1&&c[0].height<a},_setRepliedToMessageRef:function(a){this._repliedToMessageRef=a},getBoxWidth:function(){this._boxWidth||(this._boxWidth=b("DOMDimensions").measureElementBox(b("ReactDOM").findDOMNode(this.refs.bubble)||{},"width",!0,!0,!1));return this._boxWidth}});e.exports=c}),null);
__d("ChatCodePasteUtils",["cx","BanzaiODS","ChatBubble.react","MessengerFormattingUtils","React","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=/`{3,}/,i=3,j=/^\s+/,k=/\s+$/;function a(a){return!!(a&&a.search(h)!==-1)}function l(a,b){__p&&__p();var c=0;if(b-2>=0){c+=a[b-2].trim().length;var d=a[b-2].match(k);d&&(c+=d[0].length)}b-1>=0&&(c+=a[b-1].length+2*i);d=a[b].match(j);d&&(c+=d[0].length);return c}function m(a,b,c){if(a)return a.map(function(a){return Object.assign(Object.assign({},a),{offset:a.offset-b})}).filter(function(a){return 0<=a.offset&&a.offset<c});else return a}function n(a){return a.length===1?{language:"",code:a[0]}:{language:a[0].replace(/[^a-zA-Z]+/g,""),code:a.slice(1).join("\n")}}function o(a){__p&&__p();if(!b("gkx")("678575"))return a.split(h);var c=b("MessengerFormattingUtils").getRanges(a).filter(function(a){return a.formatter===b("MessengerFormattingUtils").formatConfigs.blockquote.formatter||a.formatter===b("MessengerFormattingUtils").formatConfigs.blockcode.formatter}).sort(function(a,b){return a.offset!==b.offset?a.offset-b.offset:b.length-a.length}),d=[],e=0,f=0;for(var g=0;g<c.length;g++){var i=c[g];if(i.offset<f)continue;i.formatter===b("MessengerFormattingUtils").formatConfigs.blockcode.formatter&&(d.push(a.substring(e,i.offset)),d.push(i.innerText),e=i.offset+i.length);f=i.offset+i.length}d.push(a.substring(e));return d}function c(a,c,d,e,f){__p&&__p();a=o(a);var g=[],h=0;for(var i=0;i<a.length;i+=2){var j=a[i].trim();if(j&&j.length>0){h+=l(a,i);var k=d?m(d,h,j.length):d;g.push(b("React").createElement("div",{key:i,className:"_1e-x _n4o"},b("React").createElement(b("ChatBubble.react"),{body:j,customColor:f||void 0,className:"clearfix _5wdf",maxWidth:c,ranges:k||void 0,threadID:e||void 0})))}if(i+1<a.length&&a[i+1]){j=a[i+1].split("\n");k=n(j);j=k.language;k=k.code;b("BanzaiODS").bumpEntityKey("chat_code_paste","render_bubble");g.push(b("React").createElement("div",{key:i+1,className:"_1e-x _n4o"},b("React").createElement("div",{ref:"bubble",className:"_3_om _4yng _5wdf"},b("React").createElement("div",{style:{maxWidth:c},ref:"syntaxTarget"+i,className:"language-"+j},k))))}}return g}e.exports={containsCodeBlock:a,getCodeAndMessageBubbles:c}}),null);
__d("ChatTabBlinking",["cx","ChatConfig","CSS","FantaTabActions","clearInterval","setIntervalAcrossTransitions"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ChatConfig").get("chat_tab_m4_header")?1200:600,i="highlightTitle";a={_blinkMap:{},_interval:null,_isHighlighting:!1,blinkTab:function(a,b){this._blinkMap[a]||(this._blinkMap[a]={view:b,elem:b.getTabElem()}),this.checkInterval()},unblinkTab:function(a){if(this._blinkMap[a]){var c=this._blinkMap[a].elem;c&&(b("ChatConfig").get("chat_tab_m4_header")?setTimeout(function(){b("FantaTabActions").unhighlightNewMessage(a)}):b("CSS").removeClass(c,i));delete this._blinkMap[a]}this.checkInterval()},checkInterval:function(){var a=Object.keys(this._blinkMap).length;a>0?this._interval||(this._interval=b("setIntervalAcrossTransitions")(this._toggleBlinkHighlight.bind(this),h)):this._interval&&(b("clearInterval")(this._interval),this._interval=null)},_toggleBlinkHighlight:function(){__p&&__p();var a=this;this._isHighlighting=!this._isHighlighting;var c=function(c){if(Object.prototype.hasOwnProperty.call(a._blinkMap,c)){var d=a._blinkMap[c],e=d.elem;d=d.view;e&&e.parentNode&&!d.isFocused()&&!d.isHovered()?b("ChatConfig").get("chat_tab_m4_header")?a._isHighlighting?setTimeout(function(){b("FantaTabActions").highlightNewMessage(c)}):setTimeout(function(){b("FantaTabActions").unhighlightNewMessage(c)}):b("CSS").conditionClass(e,i,a._isHighlighting):a.unblinkTab(c)}};for(var d in this._blinkMap)c(d)}};e.exports=a}),null);
__d("ChatCloseButton.react",["cx","fbt","Link.react","React","TrackingNodes","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){var a=b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.CLOSE_BUTTON),c=h._("Press Esc to close"),d=h._("Close tab"),e="_4vu4";return b("React").createElement(b("Link.react"),{"aria-label":this.props.active?c:d,className:b("joinClasses")(this.props.className,"close","button",e),"data-ft":a,"data-hover":"tooltip","data-tooltip-content":this.props.active?c:d,"data-tooltip-position":"above",onClick:this.props.onClick,onKeyUp:this.props.onKeyUp,onMouseDown:this.props.onMouseDown})};function a(){i.apply(this,arguments)}a.propTypes={onClick:c.func,onKeyUp:c.func,onMouseDown:c.func,active:c.bool};a.defaultProps={active:!1};e.exports=a}),null);
__d("ChatCollapsedLogMessageGroup.react",["cx","fbt","Link.react","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=babelHelpers.inherits(a,b("React").PureComponent);i=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=i.constructor).call.apply(a,[this].concat(d)),this.state={collapsed:!0},b}a.prototype.render=function(){var a=h._("See Latest Activity"),c=h._("See Less Activity");return b("React").createElement("div",{className:"_5w0o"},b("React").createElement(b("Link.react"),{className:"_4ea1",onClick:function(){return this.setState({collapsed:!this.state.collapsed})}.bind(this)},this.state.collapsed?a:c),this.state.collapsed?null:b("React").createElement("div",null,b("React").createElement("div",{className:"_2zsu"}),this.props.children,b("React").createElement("div",{className:"_2zsu"})))};e.exports=a}),null);
__d("ChatDateBreak.react",["cx","FBLogger","React","formatDate","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.shouldComponentUpdate=function(a){return this.props.date.getTime()!==a.date.getTime()};a.prototype.render=function(){try{var a=b("formatDate")(this.props.date,{future:"g:ia",today:"g:ia",withinWeek:"D g:ia",thisYear:"M jS, g:ia",older:"m/d/Y g:ia"});return b("React").createElement("time",{className:b("joinClasses")(this.props.className,"_5w-5")},b("React").createElement("span",{className:"_5w-6"},a))}catch(a){b("FBLogger")("mercury").catching(a).mustfix("incorrect format in datebreak");return null}};function a(){h.apply(this,arguments)}a.propTypes={date:c.instanceOf(Date).isRequired};e.exports=a}),null);
__d("ChatMessage.react",["csx","cx","fbt","BootloadedComponent.react","ChatAnimatedGifs","ChatBubble.react","ChatCodePasteUtils","ChatConfig","CSS","EmojiLikeUtils","ImmutableObject","JSResource","Locale","MercuryAttachment","MercuryDisplayTimeFilterMessageRenderer","MercuryErrorInfo","MercuryIDs","MercuryMessageError.react","MercuryTimestamp","MessengerDecorator","MessengerInnerDecorators.react","MessengerMessage.bs","MessengerVideoAutoplayStore","MNCommerceMessageType","React","ReactDOM","TooltipData","XUISpinner.react","convertMIGColorToFIGColor","immutable","isRTL","joinClasses","setImmediate"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);j=d&&d.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=j.constructor).call.apply(a,[this].concat(d)),this.state={isVisible:!1,isHighlighted:!1,hovered:!1},this.$3=function(){return this.setState({hovered:!0})}.bind(this),this.$4=function(){return this.setState({hovered:!1})}.bind(this),b}a.prototype.componentDidMount=function(){b("CSS").conditionClass(b("ReactDOM").findDOMNode(this),"_2cnu",this.isOneLine()),this.setState({isVisible:b("MessengerVideoAutoplayStore").isVisible(this.props.message.thread_id,this.props.message.message_id)}),this.$1=b("MessengerVideoAutoplayStore").addListener(function(a){a=b("MessengerVideoAutoplayStore").isVisible(this.props.message.thread_id,this.props.message.message_id);a!==this.state.isVisible&&this.setState({isVisible:a})}.bind(this))};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.remove()};a.prototype.isOneLine=function(){var a=this.props.message;return b("MessengerMessage.bs").isInbound(a)&&!this.refs.attachmentsInside&&this.refs.bubble&&!this.refs.bubble.contentWraps()};a.prototype.shouldComponentUpdate=function(a,b){var c=a.message!==this.props.message,d=!1,e=!1,f=this.props.thread;if(f)d=f.custom_like_icon!==a.thread.custom_like_icon,e=f.solid_color!==a.thread.solid_color;else if(a.thread)return!0;return c||d||e||b.isVisible!==this.state.isVisible||b.isHighlighted!==this.state.isHighlighted||b.hovered!==this.state.hovered};a.prototype.render=function(){__p&&__p();var a=this.props.message,c=b("MercuryAttachment").get(a).length>0,d=b("MessengerMessage.bs").isInbound(a),e=b("MercuryIDs").isGroupChat(a.thread_id),f=b("MercuryErrorInfo").hasErrorStatus(a),g=b("ChatConfig").getBool("chat_tab_has_gradients");c="_5wd4"+(d?" _1nc7":"")+(d?"":" _1nc6")+(c?" _2_-t":"")+(d&&e?" _5ysy":"")+(f?" _1zcs":"")+(this.state.isHighlighted&&!g?" _6iuj":"");var h=this.props.isFromViewer,i=[],j=a,k=this.props.thread?b("convertMIGColorToFIGColor")(this.props.thread.solid_color):"";j&&b("MessengerDecorator").getBeforeDecorators().forEach(function(a){a.check(j)&&i.push(a.render(j,h,{customColor:k}))});d=b("MercuryAttachment").get(a).filter(function(a){return!b("MercuryAttachment").isBubblePreferred(a)});e=this.$2("outside",d);return b("React").createElement("div",{className:b("joinClasses")(this.props.className,c),onMouseEnter:this.$3,onMouseLeave:this.$4},b("React").createElement("div",{className:b("joinClasses")("._1dlq","_h8t")},i,this.$5(e)),d.some(function(a){return b("MercuryAttachment").isShareAttachment(a)})?b("React").createElement(b("MessengerInnerDecorators.react"),{message:a,isFromViewer:h||!1,hovered:this.state.hovered,messageProps:this.props,forGameChat:this.props.forGameChat}):b("React").createElement("div",{className:"_40qi"+(this.state.isHighlighted&&g?" _6iuj":"")}),this.$6())};a.prototype.$5=function(a){var c=this.props.message,d={},e=b("MessengerMessage.bs").isOutbound(c);if(e||this.props.needsTimestampTooltip){var f=i._("{time}",[i._param("time",b("MercuryTimestamp").getPreciseTimestamp(c.timestamp))]);Object.assign(d,b("TooltipData").propsFor(f,e?"right":"left"))}if(c.is_filtered_content)return b("React").createElement("div",babelHelpers["extends"]({className:"_5wd9 _5wdc uiBoxYellow clearfix",ref:"inner"},d),b("MercuryDisplayTimeFilterMessageRenderer").renderFilteredContent(c));f=c.body&&c.body!==""?b("isRTL")(c.body):b("Locale").isRTL();return b("React").createElement("div",babelHelpers["extends"]({className:"_5wd9"+(f?" direction_rtl":"")+(f?"":" direction_ltr")+" clearfix",ref:"inner"},d),this.$7(!a),a)};a.prototype.$6=function(){var a=this.props.message;return a.is_filtered_content||!b("MessengerMessage.bs").hasError(a)?null:b("React").createElement("div",{className:"_3ry4",ref:"undertext"},b("React").createElement(b("MercuryMessageError.react"),{className:"_5wda clearfix",message:a,ref:"status"}),this.$8())};a.prototype.$8=function(){return this.props.message.is_spoof_warning?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("span",null),bootloadLoader:b("JSResource")("MercurySpoofWarning.react").__setRef("ChatMessage.react"),authorID:this.props.message.author,className:"_5wdb"}):null};a.prototype.$9=function(){return b("React").createElement("div",{style:{padding:"20px",text_align:"center",background:"white"}},b("React").createElement(b("XUISpinner.react"),null))};a.prototype.$2=function(a,c){__p&&__p();if(this.props.message.commerce_message_type===b("MNCommerceMessageType").RIDE_INTENT)return null;var d=this.props.message,e=this.props.thread?this.props.thread.custom_like_icon:null,f=a=="inside"?"attachmentsInside":"attachmentsOutside",g=this.props.thread?b("convertMIGColorToFIGColor")(this.props.thread.solid_color):"",h=[],i=[];a==="outside"&&d&&b("MessengerDecorator").getAfterDecorators().forEach(function(a){a.check(d,this.props.isFromViewer)&&(h.push(a.render(d,this.props.isFromViewer,this.props,this.state.hovered)),i.push(a.getAdditionalClassNames()))}.bind(this));if(c.length>0){var j=b("React").createElement(b("MessengerInnerDecorators.react"),{className:"_1z_2",message:d,isFromViewer:this.props.isFromViewer||!1,hovered:this.state.hovered,messageProps:this.props,forGameChat:this.props.forGameChat});return b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:this.$9(),bootloadLoader:b("JSResource")("MercuryAttachments.react").__setRef("ChatMessage.react"),className:b("joinClasses")((a==="outside"?"_3e7u":"")+(d.body?" _16ys":"")+(g?" _3al":"")+" _n4o"+(h?" _1a6y":""),i),attachments:c,customLike:e,customColor:g,forGameChat:this.props.forGameChat,isChat:!0,afterDecorators:h,innerDecorators:j,isVisible:this.state.isVisible,maxWidth:this.props.maxBubbleWidth,message:d,onUnwrap:this.$10,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,ref:f})}return null};a.prototype.$7=function(a){__p&&__p();var c=this.props,d=c.isFromViewer,e=c.message;c=c.thread;var f=e.body,g=b("MercuryAttachment").get(e).filter(function(a){return b("MercuryAttachment").isBubblePreferred(a)});g=this.$2("inside",g);var h=[],i=[],j=e;j&&(a&&b("MessengerDecorator").getAfterDecorators().forEach(function(a){a.check(j,d)&&(h.push(a.render(j,d,this.props)),i.push(a.getAdditionalClassNames()))}.bind(this)),b("MessengerDecorator").getBeforeDecorators().forEach(function(a){a.check(j,d)&&i.push(a.getAdditionalClassNames())}));var k=i.join(" ");b("ChatAnimatedGifs").shouldHideBody(e)&&(f="");var l=e.ranges;e.profile_ranges&&e.profile_ranges.length&&(l=(l||[]).concat(e.profile_ranges.map(function(a){return babelHelpers["extends"]({},a,{url:"/"+a.id})})));var m=b("ChatCodePasteUtils").containsCodeBlock(f);return(f||g)&&!b("EmojiLikeUtils").isEmojiLike(e)?b("React").createElement("div",{className:b("joinClasses")(k,"_1e-x _n4o")},m?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",{style:{height:22}}),bootloadLoader:b("JSResource")("ChatCodeBubble.react").__setRef("ChatMessage.react"),body:f,maxWidth:this.props.maxBubbleWidth,ranges:l,threadID:e.thread_id,customColor:c&&d?b("convertMIGColorToFIGColor")(c.solid_color):""}):b("React").createElement("div",{className:"_3_bl"},b("React").createElement("div",{className:"_3_bp"}),b("React").createElement(b("ChatBubble.react"),{attachments:g,body:f,className:"_5wdf",isEmojiLike:!1,isFromViewer:this.props.isFromViewer,onReplyToMessage:this.props.onReplyToMessage,metaRanges:e.meta_ranges,message:e,maxWidth:this.props.maxBubbleWidth,ranges:l,ref:"bubble",threadID:e.thread_id,customLike:e.customLike,customColor:c&&d?b("convertMIGColorToFIGColor")(c.solid_color):"",threadCustomColor:c&&b("convertMIGColorToFIGColor")(c.solid_color)})),a?b("React").createElement(b("MessengerInnerDecorators.react"),{className:"_1z_2",message:e,isFromViewer:this.props.isFromViewer||!1,hovered:this.state.hovered,messageProps:this.props,forGameChat:this.props.forGameChat}):null,h):null};a.prototype.highlightMessage=function(){this.setState({isHighlighted:!1}),b("setImmediate")(function(){return this.setState({isHighlighted:!0})}.bind(this))};a.propTypes={forGameChat:c.bool.isRequired,message:c.object.isRequired,maxBubbleWidth:c.number.isRequired,onAttachmentLoad:c.func,onStickerClick:c.func,participants:c.instanceOf(b("immutable").Map).isRequired,readReceipts:c.instanceOf(b("immutable").OrderedMap).isRequired,thread:c.instanceOf(b("ImmutableObject")),needsTimestampTooltip:c.bool};e.exports=a}),null);
__d("SplitImage.bs",["ReasonReact.bs","SplitImage.react","bs_js_null_undefined"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d,e,f){return b("ReasonReact.bs").wrapJsForReason(b("SplitImage.react"),{border:b("bs_js_null_undefined").fromOption(e),size:a,srcs:c,className:b("bs_js_null_undefined").fromOption(d)},f)}f.make=a}),null);
__d("FantaProfilePresence.bs",["cx","React","goURI","LinkReact.bs","bs_caml_array","ChatConfig","ImageReact.bs","MercuryIDs","SplitImage.bs","ReasonReact.bs","bs_js_primitive","MessengerHoverCardLink","WorkChatAvailabilityStatusLoader","LazyWorkMultiCompanyChatTooltipReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").statelessComponent("FantaProfilePresence");function i(a,c,d,e,f,g,i,j,k,l,m,n,o){__p&&__p();var p=i!==void 0?i:"",q=j!==void 0?j:!1,r=k!==void 0?k:!1;return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(){__p&&__p();var h=b("ChatConfig").get("chat_tab_m4_header")&&a.length>1;if(h){var i=Math.round(c/3)|0;i=c-i|0;i=b("React").createElement("div",{className:"_44yp",style:{height:c.toString()+"px",width:c.toString()+"px"}},b("React").createElement("div",{className:"_1gyw"},b("ReasonReact.bs").element(void 0,void 0,b("ImageReact.bs").make(void 0,"",void 0,void 0,b("bs_caml_array").caml_array_get(a,0),i,void 0,i,void 0,[]))),b("React").createElement("div",{className:"_1gyw",style:{borderColor:p}},b("ReasonReact.bs").element(void 0,void 0,b("ImageReact.bs").make(void 0,"",void 0,void 0,b("bs_caml_array").caml_array_get(a,1),i,void 0,i,void 0,[]))))}else i=b("ReasonReact.bs").element(void 0,void 0,b("SplitImage.bs").make(c,a,"_1gyw",e,[]));i=b("ReasonReact.bs").element(void 0,void 0,b("LinkReact.bs").make(void 0,void 0,g,"_2yg8",void 0,"tooltip",g,void 0,void 0,f,void 0,function(a){if(f.length>0){b("goURI")(f,void 0,void 0);a.stopPropagation();return 0}else return 0},void 0,void 0,void 0,void 0,void 0,-1,void 0,void 0,[i]));var j=l&&m!==void 0;if(j){j=b("MessengerHoverCardLink").constructEndpoint({id:m});j=b("React").cloneElement(i,{"data-hovercard":j})}else j=i;i=function(){if(n!==void 0&&m!==void 0){var a=b("bs_js_primitive").valFromOption(m),c=b("MercuryIDs").getParticipantIDFromUserID(a);c=b("bs_js_primitive").valFromOption(n).get(c);if(!(c==null)&&b("WorkChatAvailabilityStatusLoader").isLoaded())return b("WorkChatAvailabilityStatusLoader").getStoreEnforce().getDescriptionWithUserName(c.short_name,a);else return void 0}};if(r){var k=b("React").createElement("div",{className:"_466z _76q_",style:{backgroundColor:p,borderColor:p}});i=i(0);i=i!==void 0?b("React").cloneElement(k,{"data-tooltip-content":i,"data-hover":"tooltip"}):k}else i=q?b("ReasonReact.bs").element(void 0,void 0,b("LazyWorkMultiCompanyChatTooltipReact.bs").make([b("React").createElement("div",{className:"_4rwy"})])):d?b("React").createElement("div",{className:"_1gyx",style:{borderColor:p}}):null;return b("React").createElement("div",{"aria-hidden":!0,className:"_6--1"+(h?" _44yq":""),style:{height:c.toString()+"px",width:c.toString()+"px"}},j,i)},h[9],h[10],h[11],h[12]]}a=b("ReasonReact.bs").wrapReasonForJs(h,function(a){return i(a.images,a.imageSize,a.isActive,b("bs_js_primitive").nullable_to_opt(a.border),a.threadHref,a.tooltip,b("bs_js_primitive").nullable_to_opt(a.backgroundColor),a.showMultiCompany,void 0,a.isCanonical,b("bs_js_primitive").nullable_to_opt(a.threadFBID),b("bs_js_primitive").nullable_to_opt(a.participants),[])});f.component=h;f.make=i;f.jsComponent=a}),null);
__d("ChatMessageGroup.react",["cx","fbt","ChatConfig","ChatDateBreak.react","ChatMessage.react","ChatRemovedMessageTombstone.react","CurrentUser","FantaProfilePresence.bs","ImmutableObject","MercuryAttachmentLayoutTypeHelper","MercuryIDs","MercuryTimestamp","MessengerParticipants.bs","MessengerTextWithEmoticons.react","QE2Logger","React","ReactDOM","ShortProfiles","WorkForeignEntityType","gkx","immutable"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("FantaProfilePresence.bs").jsComponent;a=b("immutable").OrderedMap;c=b("React").PropTypes;var j=new(b("ImmutableObject"))({name:"",href:"#"});d=b("React").createClass({displayName:"ChatMessageGroup",propTypes:{activeMessageID:c.string,author:c.string,forGameChat:c.bool,hasDateBreak:c.bool,isCanonical:c.bool,isFromViewer:c.bool,isPageMessage:c.bool,isOnline:c.bool,maxBubbleWidth:c.number,messages:c.instanceOf(b("immutable").List).isRequired,readReceipts:c.instanceOf(a).isRequired,onAttachmentLoad:c.func,onStickerClick:c.func,persona:c.object,thread:c.instanceOf(b("ImmutableObject")),threadID:c.string},getInitialState:function(){return{participants:{}}},componentDidMount:function(){b("QE2Logger").logExposureForUser("messenger_growth_tombstone"),this._subscription=this._computeParticipants()},shouldComponentUpdate:function(a,c){return this.props.isOnline!==a.isOnline||this.props.activeMessageID!==a.activeMessageID||this.props.isFromViewer!==a.isFromViewer||!b("immutable").is(this.props.messages,a.messages)||this.state.participants!==c.participants||!b("immutable").is(this.props.thread,a.thread)},componentDidUpdate:function(a){a=k(this.props);!this._subscription&&!a.every(function(a){return this.state.participants[a]}.bind(this))&&(this._subscription=this._computeParticipants())},componentWillUnmount:function(){this._subscription&&b("MessengerParticipants.bs").removeCallback(this._subscription)},render:function(){return b("React").createElement("div",{className:"_4tdt"+(this.props.isFromViewer?" _ua0":"")+(this.props.isFromViewer?"":" _ua1")+(this._containsMessageWithAdminLayoutType()?" _73iv":"")+(this._hasSeenHeadsAtBottom()?" _3lil":"")},this._renderProfileColumn(),b("React").createElement("div",{className:"_ua2"},this._renderName(),b("React").createElement("div",{className:"_4tdv"},this._renderMessages())))},_needsProfileColumn:function(){if(b("ChatConfig").getBool("always_show_profile_in_one_on_one_threads"))return!0;if(!this.props.isCanonical)return!0;if(this.props.persona)return!0;var a=this.state.participants[this.props.author];return a&&a.user_type==="page"?!0:!1},_containsMessageWithAdminLayoutType:function(){return this.props.messages==null?!1:this.props.messages.some(function(a){if(a.attachments!=null&&a.attachments.length>0){a=a.attachments[0];return b("MercuryAttachmentLayoutTypeHelper").isAdminType(a)}return!1})},_renderProfileColumn:function(){__p&&__p();if(this.props.isFromViewer||!this._needsProfileColumn()||this._containsMessageWithAdminLayoutType())return null;var a=this.state.participants[this.props.author]||j,c=a.name,d=a.image_src;this.props.persona&&(c=this.props.persona.name,d=this.props.persona.profile_picture_url);c=h._("{name} {time}",[h._param("name",c),h._param("time",b("MercuryTimestamp").getPreciseTimestamp(this.props.messages.last().timestamp))]);var e=b("MercuryIDs").getUserIDFromThreadID(this.props.threadID);e=e?b("ShortProfiles").getNow(e):null;e=e&&e.is_messenger_only;var f=b("gkx")("697231")&&this.props.isOnline;f=f&&!e;e=b("CurrentUser").isWorkUser()&&((e=a)!=null?(e=e.work_foreign_entity_info)!=null?e.type:e:e)===b("WorkForeignEntityType").FOREIGN;a=this.props.persona?null:a.href;var g=this.props.thread;return b("React").createElement("div",{className:"_31o4"},b("React").createElement(i,{border:!0,imageSize:"28",images:[d],isActive:f,isCanonical:g.is_canonical,showMultiCompany:e,threadFBID:g.thread_fbid,threadHref:a,tooltip:c}))},_renderName:function(){__p&&__p();if(this.props.isCanonical&&!this.props.persona||this.props.isFromViewer)return null;var a=this.state.participants[this.props.messages.first().author];if(!a)return null;if(this.props.messages.first().replied_to_message)return null;var c=a.short_name;if(this.props.thread&&this.props.thread.custom_nickname){a=b("MercuryIDs").getUserIDFromParticipantID(a.id);this.props.thread.custom_nickname[a]&&(c=b("React").createElement(b("MessengerTextWithEmoticons.react"),{renderEmoticons:!0,renderEmoji:!0,text:this.props.thread.custom_nickname[a]}))}if(this.props.persona){a=this.state.participants[this.props.messages.first().author];c=a?h._("{persona name} from {page name}",[h._param("persona name",this.props.persona.name),h._param("page name",a.short_name)]):this.props.persona.name}return b("React").createElement("div",{className:"_4tdx"},c)},_renderMessages:function(){__p&&__p();var a=this.props.messages.size,c=[];this.props.messages.forEach(function(d,e,f){var g=d.message_id===this.props.activeMessageID;g&&!(e===0&&this.props.hasDateBreak)&&c.push(b("React").createElement(b("ChatDateBreak.react"),{date:new Date(d.timestamp),key:"db:"+d.message_id}));if(d.removed_timestamp&&d.removed_timestamp!==0){c.push(b("React").createElement(b("ChatRemovedMessageTombstone.react"),{key:d.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:d,needsTimestampTooltip:!this._needsProfileColumn(),participants:b("immutable").Map(this.state.participants),ref:d.message_id}));return}c.push(b("React").createElement(b("ChatMessage.react"),{forGameChat:!!this.props.forGameChat,isFromViewer:this.props.isFromViewer,key:d.message_id,maxBubbleWidth:this.props.maxBubbleWidth,message:d,participants:b("immutable").Map(this.state.participants),readReceipts:this.props.readReceipts,ref:d.message_id,nextTimestamp:this._getNextTimestamp(f,a,e),onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,thread:this.props.thread,needsTimestampTooltip:!this._needsProfileColumn()}))}.bind(this));return c},_hasSeenHeadsAtBottom:function(){var a=this.props,b=a.messages,c=a.nextTimestamp;a=a.readReceipts;var d=b.last().timestamp,e=0;a.forEach(function(a){return a>=d&&a<c&&++e===2?!1:null});return e===2},_getNextTimestamp:function(a,b,c){return c<b-1?a.get(c+1).timestamp:this.props.nextTimestamp},getMessageElement:function(a){return b("ReactDOM").findDOMNode(this.refs[a])},getMessage:function(a){return this.refs[a]},_computeParticipants:function(){__p&&__p();var a=k(this.props),c={},d=[];a.forEach(function(a){var e=b("MessengerParticipants.bs").getNow(a);c[a]=e;e||d.push(a)});this.setState({participants:c});return d.length>0?b("MessengerParticipants.bs").getMulti(d,function(b){var a=this.state.participants;d.forEach(function(c){a[c]=b[c]});this._subscription=null;this.setState({participants:a})}.bind(this)):null}});function k(a){var b=[a.author];a.readReceipts.forEach(function(a,c){b.push(c)});return b}e.exports=d}),null);
__d("ChatConversation.react",["ChatCollapsedLogMessageGroup.react","ChatDateBreak.react","ChatMessageGroup.react","MercuryIDs","MercuryLogMessageContainer.react","MercuryShareAttachmentRenderLocations","MessageList.react","MessengerReadReceipt.bs","React","cancelAnimationFrame","immutable","requestAnimationFrame"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("immutable").OrderedMap;a=b("React").PropTypes;c=b("React").createClass({displayName:"ChatConversation",_raf:void 0,_onMountTimeout:void 0,propTypes:{contextBanner:a.object,forGameChat:a.bool.isRequired,isCanonical:a.bool.isRequired,loadMoreMessages:a.func,maxBubbleWidth:a.number.isRequired,messages:a.instanceOf(b("immutable").List).isRequired,onAttachmentLoad:a.func,onMount:a.func,onStickerClick:a.func,thread:a.object,threadID:a.string.isRequired,viewer:a.string.isRequired},componentDidMount:function(){this._raf=b("requestAnimationFrame")(function(){this._onMountTimeout=setTimeout(function(){this.props.onMount&&this.props.onMount(),delete this._onMountTimeout}.bind(this),0),delete this._raf}.bind(this))},componentWillUnmount:function(){this._raf&&b("cancelAnimationFrame")(this._raf),clearTimeout(this._onMountTimeout)},render:function(){return b("React").createElement("div",null,this.props.contextBanner,b("React").createElement(b("MessageList.react"),{DateBreak:b("ChatDateBreak.react"),forGameChat:this.props.forGameChat,LogMessage:b("MercuryLogMessageContainer.react"),MessageGroup:b("ChatMessageGroup.react"),deliveryTimestamp:0,isCanonical:this.props.isCanonical,location:b("MercuryShareAttachmentRenderLocations").CHAT,loadMoreMessages:this.props.loadMoreMessages,maxBubbleWidth:this.props.maxBubbleWidth,CollapsedLogMessageGroup:b("ChatCollapsedLogMessageGroup.react"),messages:this.props.messages,onAttachmentLoad:this.props.onAttachmentLoad,onStickerClick:this.props.onStickerClick,readReceipts:this._calculateReceipts(this.props),ref:"messageList",viewer:this.props.viewer,thread:this.props.thread,threadID:this.props.threadID}))},_calculateReceipts:function(a){__p&&__p();var c=b("MercuryIDs").getParticipantIDFromUserID(a.viewer),d=b("MessengerReadReceipt.bs").getSeenTimestamps(a.readReceipts,a.threadID),e=new Set(a.thread?a.thread.participants:d.keys());e["delete"](c);return d.withMutations(function(c){b("immutable").Seq(a.messages).reverse().forEach(function(a){if(e.size===0)return!1;if(!e.has(a.author))return null;c.update(a.author,function(b){return!b||b.watermark<=a.timestamp?{watermark:a.timestamp,action:a.timestamp}:b});e["delete"](a.author);return null})})},getMessageList:function(){return this.refs.messageList}});e.exports=c}),null);
__d("ChatDetailStack.react",["cx","React"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var c=a.bottomDetail;a=a.topDetail;c=c?b("React").createElement("div",{className:"_4jeh"},c):null;return b("React").createElement("div",{className:"_2rt2"},b("React").createElement("div",{className:"_4jeg"},a),c)}e.exports=a}),null);
__d("ChatEditParticipantsUtils",["AsyncDialog","AsyncRequest","MercuryIDs","MercuryThreadIDMap","URI"],(function(a,b,c,d,e,f){"use strict";var g=b("MercuryThreadIDMap").get();a={showParticipantsModal:function(a){if(!b("MercuryIDs").isGroupChat(a))return;g.getServerIDFromClientID(a,function(a){b("AsyncDialog").send(new(b("AsyncRequest"))(new(b("URI"))("/ajax/browser/dialog/multichat_members/").addQueryData({id:a})))})}};e.exports=a}),null);
__d("ChatTabComposerContainer.react",["cx","fbt","Bootloader","ChatComposer","ChatConfig","FantaMessageActions","FantaTabActions","Keys","LogHistory","MercuryIDs","MercuryMessageActions","MercuryShareAttachmentRenderLocations","MessengerBotMenuDataFetcher","MessengerState.bs","MNCommercePageSetting","P2PGKValues","PhotosUploadWaterfall","React","ReactDOM","SimpleXUIDialog","WaterfallIDGenerator","emptyFunction","getPageIDFromThreadID","getThreadTypeNameFromThreadType","performanceAbsoluteNow","setImmediate","shallowCompare"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("ChatComposer").ChatComposer,k="right",l=/^\s*$/,m=b("LogHistory").getInstance("chat_tab_view"),n=b("ChatConfig").get("slc_disappearing_icons"),o=b("ChatConfig").get("single_line_composer"),p=140,q=90;c=babelHelpers.inherits(a,b("React").Component);i=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={showP2PButton:this.$6(),pageID:b("getPageIDFromThreadID")(this.props.threadID),showStructuredMenu:this.$7(),longInput:!1},this.$9=function(a){this.$2=a}.bind(this),this.$10=function(a){this.$3&&this.$3.uploadFiles([].concat(a))}.bind(this),this.$11=function(a){this.$5=a}.bind(this),this.$12=function(a){this.$3=a}.bind(this),this.onSend=function(a){this.props.forGameChat&&b("Bootloader").loadModules(["GamesQuicksilverFunnelLogger"],function(a){a.logGameChatSendMessage(a.getDefaultFunnelName())},"ChatTabComposerContainer.react");if(a&&a.profile_ranges&&a.profile_ranges.length){var c=a,d=this.props.thread;b("Bootloader").loadModules(["MessengerMentionsTypedLogger","MessengerMentionsLoggerEvents"],function(a,e){new a().setEvent(e.MENTION).setGroupSize(d&&d.participants&&d.participants.length).setNumDelivered((c.profile_ranges||[]).length).setThreadid(d&&d.thread_id).setThreadType(b("getThreadTypeNameFromThreadType")(d&&d.thread_type)).setOfflineThreadid(c.offline_threading_id).log()},"ChatTabComposerContainer.react")}o?this.$2&&this.$2.onSend&&this.$2.onSend(a):this.refs.composer&&this.refs.composer.onSend(a)}.bind(this),this.focusInput=function(){var a=this.getInput();a&&a.focus&&a.focus()}.bind(this),this.$14=function(a){a=this.getInput();a&&typeof a.handleSend==="function"&&(a&&a.handleSend())}.bind(this),this.$33=function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).confirmAttachmentPlaceholder(c.upload_id,c),this.$27(c)}.bind(this),this.$35=function(a){var b,c;switch(a.error){case"size-exceeded":b=h._("The file you have selected is too large");c=h._("The file you have selected is too large. The maximum size is 25MB.");break;default:b=h._("File Upload Failed"),c=h._("There was a problem uploading the file.")}this.$38(b,c);this.$22(a)}.bind(this),this.$32=function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(c.upload_id,c),this.$26(c)}.bind(this),this.$37=function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(c.upload_id,c);a=h._("File Upload Failed");var d=h._("There was a problem uploading the file.");c.errorDialogParams&&(a=c.errorDialogParams.title||a,d=c.errorDialogParams.body||d);this.$38(a,d);this.$22(c)}.bind(this),this.$34=function(a,c){b("MercuryMessageActions").getForFBID(this.props.viewer).cancelAttachmentPlaceholder(c.upload_id,c);a=h._("Upload Failed");var d=h._("Please try again. Make sure you are uploading a valid file.");c.errorDialogParams&&(a=c.errorDialogParams.title||a,d=c.errorDialogParams.body||d);this.$38(a,d);this.$24&&this.$24(c)}.bind(this),this.$36=function(a,b){this.$28&&this.$28(b)}.bind(this),this.$17=function(a,b){this.$20(a,b)}.bind(this),this.$16=function(a){this.props.onEscape&&this.props.onEscape(a)}.bind(this),this.$18=function(a,c){var d=this.props.threadID;d&&(this.$4=b("setImmediate")(function(){this.$4=null,b("FantaMessageActions").composerTextUpdate(d,a,c)}.bind(this)));this.$8()}.bind(this),this.$20=function(a,c){var d=this.props.threadID;a.keyCode===b("Keys").RETURN&&!a.shiftKey&&(a.preventDefault(),this.$13(c));if(a.keyCode===b("Keys").DOWN&&a.shiftKey&&this.hasEmptyInput()){b("FantaTabActions").minimizeTab(d);return}}.bind(this),this.$13=function(a){var b=this.$40();b==null||b.length===0?this.$41(a,[]):this.$41(a,b)}.bind(this),this.$15=function(a){var b=this.getInput();b&&b.insertEmoji(a)}.bind(this),this.$21=function(a,b,c){this.props.onSendHotLike(a.emoji,b,c,this.focusInput)}.bind(this),this.$23=function(){this.props.onSendMessage("",this.props.composer,this.onSend)}.bind(this),this.$25=function(a){this.props.onSelectSticker(a,b("emptyFunction"))}.bind(this),this.$28=function(a){this.$42(b("PhotosUploadWaterfall").UPLOAD_START,a),this.props.onSendPhoto(a,this.onSend),this.$43("submit",a),this.focusInput()}.bind(this),this.$22=function(a){this.$42(b("PhotosUploadWaterfall").CLIENT_ERROR,a),this.$43("failed",a)}.bind(this),this.$24=function(a){this.$42(b("PhotosUploadWaterfall").CLIENT_ERROR,a),this.$43("failed",a)}.bind(this),this.$26=function(a){this.$42(b("PhotosUploadWaterfall").CANCEL_DURING_UPLOAD,a),this.$43("canceled",a)}.bind(this),this.$27=function(a){this.$42(b("PhotosUploadWaterfall").ALL_UPLOADS_DONE,a);this.$43("completed",a);a=a.image_ids.length||a.attachments.length;this.$44(a)}.bind(this),c}a.prototype.shouldComponentUpdate=function(a,c){return b("shallowCompare")(this,a,c)};a.prototype.componentDidMount=function(){var a=b("performanceAbsoluteNow")();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){b.markerPoint(c.FIRSTCHATTABOPEN_WWW,"mount_composer_container",JSON.stringify(this.state),0,a)}.bind(this),"ChatTabComposerContainer.react");this.props.isFocused&&!this.props.isNewEmptyLocalThread&&this.focusInput();this.state.pageID&&b("MessengerBotMenuDataFetcher").getHasPageSetting(this.state.pageID,function(a){this.setState({showStructuredMenu:a})}.bind(this),function(){this.setState({showStructuredMenu:!1})}.bind(this),b("MNCommercePageSetting").STRUCTURED_MENU_ENABLED)};a.prototype.componentDidUpdate=function(a){var b=this.props.thread;b=b?b.thread_id:null;b===this.props.threadID&&(this.props.fileUploader!==a.fileUploader&&this.$8())};a.prototype.$6=function(){return b("P2PGKValues").P2PVisible&&this.props.viewer!==b("MercuryIDs").getUserIDFromThreadID(this.props.threadID)};a.prototype.$7=function(){var a=b("getPageIDFromThreadID")(this.props.threadID);return a===null||a===void 0?!1:b("MessengerBotMenuDataFetcher").getHasPageSetting(a,function(){},function(){},b("MNCommercePageSetting").STRUCTURED_MENU_ENABLED)};a.prototype.render=function(){var a=this.props.composer,c=this.props,d=c.thread;c=c.threadID;var e=c?b("MessengerState.bs").isEmptyLocalThread(this.props.viewer,c):!1;return o?b("React").createElement(j,{composer:a,enableDisappearingIcons:n,fileUploader:this.props.fileUploader,handleSend:this.$13,handleSendClick:this.$14,inputRef:this.$9,isEmptyLocalThread:e,isFocused:this.props.isFocused,defaultText:a.text,onEmojiSelect:this.$15,onEscape:this.$16,onInputKeyDown:this.$17,onTab:this.props.onTab,onTextChange:this.$18,onUploaderMount:this.$12,pageID:this.state.pageID,participantIDs:void 0,disableInput:this.props.disableInput,showP2PButton:this.state.showP2PButton,showStructuredMenu:this.state.showStructuredMenu,thread:d,threadID:c,uploadPhotoFn:this.$10,viewer:this.props.viewer,focusInput:this.focusInput,longInput:this.state.longInput,ref:this.$11,forGameChat:this.props.forGameChat}):b("React").createElement(j,{defaultText:a.text,fileUploaderProps:this.$19(),handleSendClick:this.$14,isEmptyLocalThread:e,ref:"composer",composer:this.props.composer,fileUploader:this.props.fileUploader,handleSend:this.$13,inputKeyDown:this.$20,isFocused:this.props.isFocused,onCustomLikeSelect:this.$21,onEmojiSelect:this.$15,onEscape:this.props.onEscape,onFileUploadFail:this.$22,onP2PTrigger:this.$23,onPhotoUploadFail:this.$24,onStickerSelect:this.$25,onTab:this.props.onTab,onUploadCancel:this.$26,onUploadComplete:this.$27,onUploadSubmit:this.$28,thread:d,threadID:c,viewer:this.props.viewer,disableInput:this.props.disableInput,onTextChange:this.$18,p2pProps:this.$29(),pageID:this.state.pageID,participantIDs:void 0,photoUploaderProps:this.$30(),showP2PButton:this.state.showP2PButton,showStructuredMenu:this.state.showStructuredMenu,stickerButtonProps:this.$31(),forGameChat:this.props.forGameChat})};a.prototype.getInput=function(){return o?this.$2:this.refs.composer&&this.refs.composer.getInput&&this.refs.composer.getInput()};a.prototype.isUploading=function(){return this.refs.composer.isUploading()};a.prototype.$29=function(){return!this.state.showP2PButton?{}:{button:b("React").createElement("i",{className:"hidden_elem"}),className:"_6ga _6gb _6wm4 _6jtl",flyoutAlignment:k,referrer:b("MercuryShareAttachmentRenderLocations").CHAT,threadID:this.props.threadID,onTrigger:this.$23}};a.prototype.$31=function(){var a={className:"_6gb _6wm4 _6gf _6jtm",flyoutAlignment:k,threadID:this.props.threadID,onStickerSelect:this.$25};return a};a.prototype.$30=function(){var a={className:"_6gd",customUI:!0,imageClassName:"hidden_elem",linkClassName:"_6gb _6wm4 _6ge _6jtn",threadID:this.props.threadID,onLastUploadCancel:this.$32,onAllUploadsComplete:this.$33,onLastUploadFail:this.$34,onUploadError:this.$35,onSubmit:this.$36};return a};a.prototype.$19=function(){var a=this.$30();a.linkClassName="_6gb _6wm4 _6gg _6jto";a.imagesOnly=!1;a.onLastUploadFail=this.$37;return a};a.prototype.$38=function(a,c){b("SimpleXUIDialog").show(c,a)};a.prototype.$8=function(){if(!this.$5)return;var a=b("ReactDOM").findDOMNode(this.$5);if(!a)return;a=a.clientHeight;!this.state.longInput&&a>p?this.setState({longInput:!0}):this.state.longInput&&a<q&&this.setState({longInput:!1})};a.prototype.hasEmptyInput=function(){return l.test(this.$39())};a.prototype.$39=function(){var a=this.getInput();return a&&a.getValue()||""};a.prototype.$41=function(a,b){this.props.onSendMessage({message:a,mentions:b},this.props.composer,this.onSend);return};a.prototype.$40=function(){var a=this.getInput();return a&&a.getMentions?a.getMentions():null};a.prototype.$42=function(a,c){this.$1==null&&(this.$1=b("WaterfallIDGenerator").generate()),b("PhotosUploadWaterfall").sendSignal(babelHelpers["extends"]({qn:this.$1,step:a,uploader:b("PhotosUploadWaterfall").APP_CHAT},c||{}))};a.prototype.$44=function(a){if(a===0)return;this.$42(b("PhotosUploadWaterfall").POST_PUBLISHED,{count:a});this.$1=b("WaterfallIDGenerator").generate()};a.prototype.$43=function(a,b){m.debug("photo_uploader:"+a,"{}")};e.exports=a}),null);
__d("ChatTabMenuBootloader.react",["cx","fbt","AutoFocusableLink.react","BootloadOnInteraction.react","ChatTabMenuIcon.bs","ErrorBoundary.react","JSResource","LazyComponent.react","MercuryConfig","MercuryThreadInfo","MessageRequestUtils","Placeholder.react","React","getPageIDFromThreadID","immutable","isEmpty","lazyLoadComponent"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("ChatTabMenuIcon.bs").jsComponent,k=b("lazyLoadComponent")(b("JSResource")("MessengerReportNUX.react").__setRef("ChatTabMenuBootloader.react"));i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.$1=function(){var a=this.props.thread;return!!a&&b("MercuryThreadInfo").showComposer(a)&&!b("isEmpty")(a.participants)&&!b("MessageRequestUtils").isMessageRequest(a)&&!b("MercuryConfig").ViewerIsReadOnly&&!(b("MercuryConfig").ColdOpenBlock&&(b("MercuryThreadInfo").isColdOpen(a)||b("MercuryThreadInfo").isEmptyLocalThread(a)))&&!(this.props.isPageChat&&a.message_count===0)};a.prototype.render=function(){if(!this.$1())return null;var a=h._("Options");return b("React").createElement("div",{className:"_461_",ref:"menu"},b("React").createElement(b("BootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),this.props),loader:b("JSResource")("ChatTabMenu.react").__setRef("ChatTabMenuBootloader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{"aria-label":a,role:"button"},b("React").createElement(j,{iconStyle:this.props.iconStyle}))}),this.$2())};a.prototype.$2=function(){if(!this.props.showMessengerReportNux||this.props.threadID===null)return null;var a=b("getPageIDFromThreadID")(this.props.threadID);return a===null?null:b("React").createElement(b("ErrorBoundary.react"),null,b("React").createElement(b("Placeholder.react"),{fallback:null},b("React").createElement(k,{contextRef:function(){return this.refs.menu}.bind(this),pageID:a,pageUnsubscribeStatus:this.props.pageUnsubscribeStatus})))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("ChatTitleLink.react",["cx","ChatConfig","ChatEditParticipantsUtils","Link.react","MercuryIDs","MercuryThreadTitleSafe.react","MessengerAdminGroupUtils","MessengerHoverCardLink","React","TrackingNodes","UserAgent","goURI"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"ChatTitleLink",propTypes:{href:a.string,isNewMessageTab:a.bool,thread:a.object,viewer:a.string},getDefaultProps:function(){return{href:null}},render:function(){if(!this.props.thread)return null;var a=this.props,c=a.href,d=a.thread,e=a.viewer;a=babelHelpers.objectWithoutPropertiesLoose(a,["href","thread","viewer"]);var f="";b("ChatConfig").get("chat_tab_m4_header")&&d&&d.thread_id&&(f=b("MessengerHoverCardLink").constructEndpoint({id:b("MercuryIDs").getThreadFBIDFromThreadID(d.thread_id)}));return b("React").createElement(h,babelHelpers["extends"]({className:"titlebarText"+(b("UserAgent").isBrowser("Chrome")&&!b("UserAgent").isPlatform("Windows")?" fixemoji":"")+(c===null?" noLink":""),"data-ft":b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.TITLE),"data-hover":"tooltip",onClick:function(a){return this._handleClick(a)}.bind(this),"data-hovercard":f.toString(),href:c},a),b("React").createElement(b("MercuryThreadTitleSafe.react"),{isNewThread:this.props.isNewMessageTab,thread:d,useAndSeparator:!0,useShortName:!d.is_canonical,viewer:e}))},_handleClick:function(a){var c=this.props,d=c.href;c=c.thread;if(!d)return;c&&c.associated_object?b("goURI")(d):b("MessengerAdminGroupUtils").showParticipantsModal(c.is_canonical,this.props.isNewMessageTab,c)&&(b("ChatEditParticipantsUtils").showParticipantsModal(c.thread_id),a.preventDefault())}});var h=function(a){return a.href?b("React").createElement(b("Link.react"),a):b("React").createElement("span",a)};e.exports=c}),null);
__d("ChatVideoCallButtonBootloader.react",["cx","AutoFocusableLink.react","BootloadOnInteraction.react","ChatVideoCallIcon.bs","JSResource","LazyComponent.react","React","VideoCallWebDriverIDs","requireWeak"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("ChatVideoCallIcon.bs").jsComponent;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=!1,this.state={RTCComponent:null},b}a.prototype.componentDidMount=function(){this.$1=!0,b("requireWeak")("ChatVideoCallButton.react",function(a){this.$1&&this.setState({RTCComponent:a})}.bind(this))};a.prototype.componentWillUnmount=function(){this.$1=!1};a.prototype.render=function(){if(this.props.isPageChat)return null;var a=this.props,c=a.isAudio;a=a.iconStyle;var d=this.state.RTCComponent;return b("React").createElement("div",{className:"_3a61"+(c?" _461a":"")+(c?"":" _461b"),"data-testID":c?b("VideoCallWebDriverIDs").CHAT_TAB_VOICE_BUTTON:b("VideoCallWebDriverIDs").CHAT_TAB_VIDEO_BUTTON,key:"rtc"+(c?"audio":"video")},d?b("React").createElement(d,this.props):b("React").createElement(b("BootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),this.props),loader:b("JSResource")("ChatVideoCallButton.react").__setRef("ChatVideoCallButtonBootloader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{role:"button"},b("React").createElement(i,{isAudio:c,iconStyle:a}))}))};e.exports=a}),null);
__d("ChatTabHeader.react",["ix","cx","fbt","AutoFocusableLink.react","Bootloader","BootloadOnRender.react","ChatCloseButton.react","ChatConfig","ChatTitleLink.react","CurrentUser","ErrorBoundary.react","EventPlanExperiment","EventReminderStateStore","Image.react","JSResource","LayerFadeOnHide","LazyComponent.react","LoadOnRender.react","MercuryBootloadOnInteraction.react","MercuryConfig","MercuryIDs","MercuryThreadInfo","MercuryTypingAnimation_DEPRECATED.react","MessageRequestUtils","MessagingTag","MessengerAdminGroupUtils","MessengerJoinableModeType","MessengerPresenceProvider.bs","MessengerState.bs","Placeholder.react","QE2Logger","React","SimpleNUXMessage","TooltipData","WorkChatAvailabilityStatusLoader","XUIAmbientNUX.react","asset","getPageIDFromThreadID","gkx","immutable","isEmpty","lazyLoadComponent","requireWeak"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=b("React").PropTypes;var k="118809038721180",l=function(a){b("Bootloader").loadModules(["ArchiveWarningReact.bs"],function(b){b=b.jsComponent;return a(b)},"ChatTabHeader.react")},m=b("lazyLoadComponent")(b("JSResource")("ChatExpandTabButton.react").__setRef("ChatTabHeader.react")),n=b("lazyLoadComponent")(b("JSResource")("MessengerReportNUX.react").__setRef("ChatTabHeader.react"));d=babelHelpers.inherits(a,b("React").PureComponent);j=d&&d.prototype;function a(a){j.constructor.call(this,a),this.$1=!1,this.$4=function(){for(var a=arguments.length,b=new Array(a),c=0;c<a;c++)b[c]=arguments[c];this.props.onClick.apply(null,b)}.bind(this),this.$18=function(){return this.refs.menu}.bind(this),this.$19=function(){b("SimpleNUXMessage").markMessageSeenByUser(k),this.setState({eventPlanNuxSeen:!0})}.bind(this),this.state={eventPlanNuxSeen:b("SimpleNUXMessage").hasUserSeenMessage(k)}}a.prototype.componentDidMount=function(){this.$1=!0,b("requireWeak")("ChatVideoCallButton.react",function(a){this.$1&&this.setState({RTCComponent:a})}.bind(this))};a.prototype.componentWillUnmount=function(){this.$1=!1};a.prototype.render=function(){var a=this.$3(),c=this.props.isRaised;return b("React").createElement("div",{className:"_15p4 _6t9f"+(this.props.isRaised?"":" _15p5")+(c||!a?" _2pis":""),onMouseUp:this.$4,ref:"root"},b("React").createElement("div",{"aria-level":"2",className:"titlebarTextWrapper _15p6",role:"heading"},b("React").createElement("div",{className:"_61td",role:c?"presentation":"button",tabIndex:c?-1:0},a,this.$5()),this.props.isTyping&&!this.props.isRaised?b("React").createElement(b("MercuryTypingAnimation_DEPRECATED.react"),{className:"_15p8"}):null),b("React").createElement("ul",{className:"_32ca"},this.$6(),b("React").createElement("li",{className:"_32cb"},b("React").createElement(b("ChatCloseButton.react"),{active:this.props.isActive,className:"_3olu _3olv",onClick:this.props.onCloseClick}))))};a.prototype.focus=function(){this.refs.root&&this.refs.root.focus()};a.prototype.$7=function(){return this.props.thread?b("MessageRequestUtils").isMessageRequest(this.props.thread):!1};a.prototype.$8=function(){var a;if(this.props.thread===null)return null;var c=b("MessengerState.bs").getThreadMetaNow(b("CurrentUser").getID(),this.props.threadID);if(!c)return null;c=((a=c.marketplace_thread_data)==null?void 0:a.for_sale_item)||((a=c.marketplace_thread_data)==null?void 0:a.buyer_fbid)||((a=c.marketplace_thread_data)==null?void 0:a.seller_fbid);return Boolean(c)};a.prototype.$6=function(){if(!this.props.isRaised)return null;var a=[this.$9(),this.$10(),this.$11(),this.$12(),this.$13(),this.$14(),this.$15()];return a.filter(Boolean)};a.prototype.$14=function(){return this.$16({isAudio:!0})};a.prototype.$13=function(){return this.$16({isAudio:!1})};a.prototype.$16=function(a){__p&&__p();if(this.props.isEmptyChat||this.$7()||this.$8())return null;if(this.props.isPageChat)return null;var c=this.props,d=c.isGroupChat,e=c.onRTCNuxCloseButtonClick,f=c.rtcNuxShown,g=c.thread,h=c.threadID;c=c.viewer;if(d){if(!g||!b("MercuryThreadInfo").canReply(g))return null;if(g.joinable_mode&&g.joinable_mode.mode===b("MessengerJoinableModeType").JOINABLE)return null}d=babelHelpers["extends"]({isGroupChat:d,onRTCNuxCloseButtonClick:e,rtcCallData:g&&g.rtc_call_data,rtcNuxShown:f&&a.isAudio,threadID:h,thread:g,viewer:c},a);d.className="_3olv"+(d.isAudio?" _2fpc":"")+(d.isAudio?"":" _2fpd");e=this.state.RTCComponent;return b("React").createElement("li",{className:"_3a61"+(d.isAudio?" _461a":"")+(d.isAudio?"":" _461b"),key:"rtc"+(d.isAudio?"audio":"video")},e?b("React").createElement(e,d):b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),d),loader:b("JSResource")("ChatVideoCallButton.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{className:d.className,role:"button"})}))};a.prototype.$17=function(){var a=this.props.thread;return!!a&&b("MercuryThreadInfo").showComposer(a)&&!b("isEmpty")(a.participants)&&!b("MessageRequestUtils").isMessageRequest(a)&&!b("MercuryConfig").ViewerIsReadOnly&&!(b("MercuryConfig").ColdOpenBlock&&(b("MercuryThreadInfo").isColdOpen(a)||b("MercuryThreadInfo").isEmptyLocalThread(a)))&&!(this.props.isPageChat&&a.message_count===0)};a.prototype.$15=function(){__p&&__p();if(!this.$17())return null;var a=this.props,c=a.thread;a=a.isNewMessageTab;if(a||!!c&&c.folder===b("MessagingTag").PENDING)return null;a={attachmentsShelf:this.props.attachmentsShelf,hasBlockedMessages:this.props.hasBlockedMessages,isGroupChat:this.props.isGroupChat,isMultiCompany:this.props.isMultiCompany,isMuted:this.props.isMuted,isPageChat:this.props.isPageChat,membershipParticipants:this.props.membershipParticipants,participants:this.props.participants,sheetController:this.props.sheetController,thread:this.props.thread,threadID:this.props.threadID,uri:this.props.uri,viewer:this.props.viewer};a.className="_3olv _1ll-";c=i._("Options");var d=!1;if(this.props.threadID){var e=b("EventReminderStateStore").getEvent(this.props.threadID);d=e&&!e.exists&&!this.state.eventPlanNuxSeen&&b("EventPlanExperiment").shouldShowEntryPointNuxWithExposure()}return b("React").createElement("div",{key:"menu"},b("React").createElement("li",{className:"_3a61 _461_",ref:"menu"},b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),a),loader:b("JSResource")("ChatTabMenu.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{className:a.className,"aria-label":c,role:"button"})})),b("React").createElement(b("XUIAmbientNUX.react"),{alignment:"right",behaviors:{LayerFadeOnHide:b("LayerFadeOnHide")},contextRef:this.$18,onCloseButtonClick:this.$19,shown:d,width:"auto"},i._("Click here to start a new plan.")),this.$20())};a.prototype.$12=function(){if(this.props.isNewMessageTab||this.props.isPageChat||this.$7()||b("gkx")("678584"))return null;var a={className:"_3olv _3jyj",isFBAtWork:this.props.isWorkUser,shouldAddToApprovalQueue:b("MessengerAdminGroupUtils").shouldAddToApprovalQueue(this.props.thread,this.props.viewer),shown:!0,onClick:function(){return this.props.sheetController.openAddFriendsSheet()}.bind(this),thread:this.props.thread,viewer:this.props.viewer},c=i._("Add");return b("React").createElement("li",{className:"_3a61 _4620",key:"add"},b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),a),loader:b("JSResource")("ChatAddToThreadButton.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement(b("AutoFocusableLink.react"),{"aria-label":c,className:a.className,role:"button"})}))};a.prototype.$11=function(){var a=this.props,c=a.href,d=a.isNewMessageTab;a=a.isWorkUser;b("QE2Logger").logExposureForUser("messenger_chat_tabs_expand_to_m_dot_com");if(d||this.$7()||a||!b("ChatConfig").getBool("expand_button_in_header"))return null;d={className:"_3olv _6pty _6reg",shown:!0,linkToExpand:c};a=i._("Expand in a new window");return b("React").createElement("li",{className:"_3a61 _6pr0",key:"expand"},b("React").createElement(b("ErrorBoundary.react"),null,b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement(b("AutoFocusableLink.react"),{"aria-label":a,className:d.className,href:c,role:"button"})},b("React").createElement(m,d))))};a.prototype.$9=function(){if(!this.props.isViewerEmployee)return null;var a=this.props.participants;a=a?a.length>0&&a.every(function(a){return!!(a&&a.employee)}):!1;return!a?null:b("React").createElement("li",{key:"archiveWarning"},b("React").createElement(b("LoadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{shown:!0}),loader:l,placeholder:b("React").createElement("div",null)}))};a.prototype.$10=function(){if(!this.props.isWorkUser||!this.props.isMultiCompany)return null;var a=b("React").createElement(b("AutoFocusableLink.react"),{className:"_kp6",onClick:this.props.onClick,role:"presentation"});return b("React").createElement("li",{key:"multiCompanyBadge"},b("React").createElement("div",{className:"_3olv"},b("React").createElement(b("MercuryBootloadOnInteraction.react"),{component:b("React").createElement(b("LazyComponent.react"),null,a),loader:b("JSResource")("WorkMultiCompanyChatTooltip.react").__setRef("ChatTabHeader.react"),placeholder:a})))};a.prototype.$21=function(){return b("React").createElement(b("MessengerPresenceProvider.bs").jsComponent,{subscribeToIDs:[b("CurrentUser").getID()]},function(a){return b("React").createElement("span",{className:"_3a61"+(this.props.isRaised?"":" _3-99")},b("React").createElement("span",{className:"_3olv _2nlt"}))}.bind(this))};a.prototype.$22=function(){__p&&__p();if(!this.props.isDoNotDisturb)return null;if(!b("gkx")("678573"))return null;var a=this.props.threadID?b("MercuryIDs").getUserIDFromThreadID(this.props.threadID):null;if(!this.props.participants)return null;var c=this.props.participants.filter(function(b){return b.fbid===a})[0];if(!c)return null;c=b("WorkChatAvailabilityStatusLoader").isLoaded()&&a?b("WorkChatAvailabilityStatusLoader").getStoreEnforce().getDescriptionWithUserName(c.short_name,a):"";return b("React").createElement("span",{className:"_4jft"},b("React").createElement(b("Image.react"),{"data-tooltip-content":c,"data-hover":"tooltip",src:g("550341")}))};a.prototype.$5=function(){var a=this.props.thread,c=this.props.tooltip;a&&a.is_canonical&&(c="");return b("React").createElement(b("ChatTitleLink.react"),babelHelpers["extends"]({href:this.props.isRaised?this.props.href:void 0,isNewMessageTab:this.props.isNewMessageTab,thread:this.props.thread,viewer:this.props.viewer},b("TooltipData").propsFor(c,"above")))};a.prototype.$3=function(){var a=this.props,c=a.isRaised;a=a.thread;return!c&&a&&a.unread_count>0?b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{className:"_3-8_ _3-99",count:a.unread_count,type:"special"}),loader:b("JSResource")("XUIBadge.react").__setRef("ChatTabHeader.react"),placeholder:b("React").createElement("span",null)}):b("React").createElement(b("React").Fragment,null,this.$22(),this.$21())};a.prototype.$20=function(){if(!this.props.showMessengerReportNux||this.props.threadID===null)return null;var a=b("getPageIDFromThreadID")(this.props.threadID);return a===null?null:b("React").createElement(b("ErrorBoundary.react"),null,b("React").createElement(b("Placeholder.react"),{fallback:null},b("React").createElement(n,{contextRef:function(){return this.refs.menu}.bind(this),pageID:a,pageUnsubscribeStatus:this.props.pageUnsubscribeStatus})))};a.propTypes={attachmentsShelf:c.object.isRequired,hasBlockedMessages:c.bool.isRequired,href:c.string,isActive:c.bool.isRequired,isEmptyChat:c.bool,isGroupChat:c.bool,isMuted:c.bool,isPageChat:c.bool,isRaised:c.bool,isTyping:c.bool,isViewerEmployee:c.bool,isWorkUser:c.bool,onClick:c.func.isRequired,onCloseClick:c.func.isRequired,onRTCNuxCloseButtonClick:c.func.isRequired,participants:c.arrayOf(c.object),rtcNuxShown:c.bool.isRequired,sheetController:c.object.isRequired,showMessengerReportNux:c.bool.isRequired,thread:c.object,threadID:c.string,tooltip:c.string,uri:c.string,viewer:c.string.isRequired};e.exports=a}),null);
__d("ChatTabHeaderContainer.react",["ChatTabHeader.react","CurrentUser","MercuryIDs","MercuryThreadInfo","React","WorkModeConfig","getGroupNameTooltipFromParticipantIDs","getPageIDFromThreadID","immutable"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("getGroupNameTooltipFromParticipantIDs").getGroupNameTooltipFromParticipantIDs;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").PureComponent);g=d&&d.prototype;function a(a){g.constructor.call(this,a),this.state=this.calculateState(a)}a.prototype.calculateState=function(a){var c=!1,d;if(a.threadID){var e;c=a.isNewMessageTab?(((e=a.thread)==null?void 0:(e=e.participants)==null?void 0:e.length)||0)>2:b("MercuryIDs").isGroupChat(a.threadID);d=b("getPageIDFromThreadID")(a.threadID)}return{isGroupChat:c,pageID:d}};a.prototype.componentDidMount=function(){this.props.onMount&&this.props.onMount(this)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){this.setState(this.calculateState(a))};a.prototype.render=function(){var a=this.props.participants&&this.props.participants.toList().toArray(),c=this.props,d=c.isNewMessageTab;c=c.thread;var e;c&&(e=h(c.participants));var f=c&&c.participants&&c.participants.length===0;return b("React").createElement(b("ChatTabHeader.react"),{attachmentsShelf:this.props.attachmentsShelf,hasBlockedMessages:this.props.hasBlockedMessages,href:this.props.href,isActive:this.props.isActive,isEmptyChat:f,isGroupChat:this.state.isGroupChat,isMultiCompany:this.props.isMultiCompany,isDoNotDisturb:this.props.isDoNotDisturb,isMuted:!!c&&b("MercuryThreadInfo").isMuted(c),isNewMessageTab:this.props.isNewMessageTab,isPageChat:!!this.state.pageID,isRaised:this.props.isRaised,isTyping:this.props.isTyping,isViewerEmployee:b("CurrentUser").isEmployee(),isWorkUser:!!b("WorkModeConfig").is_work_user,membershipParticipants:this.props.membershipParticipants,onClick:this.props.onClick,onCloseClick:this.props.onCloseClick,onRTCNuxCloseButtonClick:this.props.onRTCNuxCloseButtonClick,pageUnsubscribeStatus:this.props.pageUnsubscribeStatus,participants:a,ref:"header",rtcNuxShown:this.props.rtcNuxShown,sheetController:this.props.sheetController,showMessengerReportNux:this.props.showMessengerReportNux,thread:c,threadID:d&&c!=null?c.thread_id:this.props.threadID,uri:this.props.uri,tooltip:e,viewer:this.props.viewer})};a.prototype.focus=function(){this.refs.header.focus()};a.propTypes={attachmentsShelf:c.object.isRequired,isActive:c.bool.isRequired,isRaised:c.bool,isTyping:c.bool,onClick:c.func.isRequired,onCloseClick:c.func.isRequired,onMount:c.func,onRTCNuxCloseButtonClick:c.func.isRequired,rtcNuxShown:c.bool.isRequired,sheetController:c.object.isRequired,showMessengerReportNux:c.bool.isRequired,thread:c.object,threadID:c.string,uri:c.string,viewer:c.string.isRequired};e.exports=a}),null);
__d("ChatDetailStack.bs",["ReasonReact.bs","ChatDetailStack.react"],(function(a,b,c,d,e,f){"use strict";function a(a,c,d){return b("ReasonReact.bs").wrapJsForReason(b("ChatDetailStack.react"),{topDetail:a,bottomDetail:c},d)}f.make=a}),null);
__d("ChatTabMenu.bs",["MercuryIDs","ReasonReact.bs","bs_js_primitive","MessengerState.bs","bs_js_null_undefined","getPageIDFromThreadID","ChatTabMenuBootloader.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e,f,g,h,i,j,k,l,m,n,o){var p=a!==void 0?b("bs_js_primitive").some(b("bs_js_primitive").valFromOption(a).thread_id):void 0;if(p!==void 0){var q=b("bs_js_primitive").valFromOption(p);q=[b("MercuryIDs").isGroupChat(q),b("MessengerState.bs").isNewEmptyLocalThread(c,q),b("bs_js_primitive").nullable_to_opt(b("getPageIDFromThreadID")(q))!==void 0]}else q=[!1,!0,!1];var r=a!==void 0?b("bs_js_primitive").valFromOption(a).message_count===0:!0;return b("ReasonReact.bs").wrapJsForReason(b("ChatTabMenuBootloader.react"),{autoFocus:!1,hasBlockedMessages:h,highlightNewMessage:k,isEmptyChat:q[1],isEmptyConversation:r,isFocused:j,isGroupChat:q[0],isMultiCompany:i,isPageChat:q[2],membershipParticipants:b("bs_js_null_undefined").fromOption(d),pageUnsubscribeStatus:e,participantsMap:b("bs_js_null_undefined").fromOption(f),showMessengerReportNux:g,isNewMessageTab:l,thread:b("bs_js_null_undefined").fromOption(a),threadID:b("bs_js_null_undefined").fromOption(p),uri:m,viewer:c,iconStyle:n},o)}f.make=a}),null);
__d("ChatThreadName.bs",["cx","React","LinkReact.bs","MercuryIDs","ReasonReact.bs","bs_js_primitive","MessengerHoverCardLink","MercuryThreadTitleReact.bs"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("ReasonReact.bs").statelessComponent("ChatThreadName");function a(a,c,d,e,f,g,i){__p&&__p();return[h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],function(){__p&&__p();if(a!==void 0){var h=b("bs_js_primitive").valFromOption(a),i=h.thread_id,j=b("ReasonReact.bs").element(void 0,void 0,b("LinkReact.bs").make(void 0,void 0,d,f,void 0,"tooltip",d,void 0,void 0,c,void 0,function(a){if(c.length>0){a.stopPropagation();return 0}else return 0},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[b("ReasonReact.bs").element(void 0,void 0,b("MercuryThreadTitleReact.bs").make("_1ogo",void 0,h,e,g,void 0,!h.is_canonical,!0,[]))]));if(h.is_canonical){h=b("MessengerHoverCardLink").constructEndpoint({id:b("MercuryIDs").getThreadFBIDFromThreadID(i)});return b("React").cloneElement(j,{"data-hovercard":h,"data-hover":""})}else return j}else return null},h[9],h[10],h[11],h[12]]}f.component=h;f.make=a}),null);
__d("ChatVideoCallButton.bs",["MercuryIDs","ReasonReact.bs","bs_js_primitive","bs_js_null_undefined","ChatVideoCallButtonBootloader.react"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(a,c,d,e,f,g,h,i,j){__p&&__p();a=a!==void 0?a:!0;d=d!==void 0?d:function(){return 0};e=e!==void 0?e:!1;i=i!==void 0?i:!0;if(g!==void 0){var k=b("bs_js_primitive").valFromOption(g);k=[b("bs_js_primitive").some(k.thread_id),b("bs_js_primitive").nullable_to_opt(k.rtc_call_data)]}else k=[void 0,void 0];var l=k[1];l=l!==void 0?b("bs_js_primitive").valFromOption(l):{call_state:"NO_ONGOING_CALL",server_info_data:null,initiator_fbid:null};k=b("bs_js_null_undefined").fromOption(k[0]);var m=b("MercuryIDs").isGroupChat(k);return b("ReasonReact.bs").wrapJsForReason(b("ChatVideoCallButtonBootloader.react"),{isAudio:a,isPageChat:c,isGroupChat:m,iconStyle:f,onRTCNuxCloseButtonClick:d,rtcNuxShown:e,threadID:k,thread:b("bs_js_null_undefined").fromOption(g),viewer:h,shown:i,rtcCallData:l},j)}f.make=a}),null);
__d("FantaCloseButton.bs",["cx","fbt","bs_curry","React","LinkReact.bs","ReasonReact.bs","TrackingNodes","TrackingNodeTypes"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("ReasonReact.bs").statelessComponent("FantaCloseButton");function a(a,c,d){return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],function(){var d=b("TrackingNodes").getTrackingInfo(b("TrackingNodeTypes").CLOSE_BUTTON),e=c?h._("Press Esc to close"):h._("Close tab");return b("ReasonReact.bs").element(void 0,void 0,b("LinkReact.bs").make(void 0,void 0,e,"_40qq _4vu4 button",d,"tooltip",e,void 0,"above",void 0,void 0,function(c){c.stopPropagation();return b("bs_curry")._1(a,c)},void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[b("React").createElement("div",{className:"close _6--c"})]))},i[9],i[10],i[11],i[12]]}f.component=i;f.make=a}),null);
__d("FantaM4Header.bs",["cx","fbt","bs_curry","React","bs_belt_Set","bs_belt_Array","MercuryIDs","bs_belt_Option","ChatTabMenu.bs","ReasonReact.bs","bs_js_primitive","ParticipantId.bs","ChatThreadName.bs","ChatDetailStack.bs","FantaCloseButton.bs","ArchiveWarningReact.bs","ChatVideoCallButton.bs","MessageRequestUtils","FantaProfilePresence.bs","MessengerParticipants.bs","getPageIDFromThreadID","MessengerCustomColorUtils.bs","MessengerParticipantUtils.bs","MessengerPresenceProvider.bs","getGroupNameTooltipFromParticipantIDs"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=b("ReasonReact.bs").statelessComponent("FantaM4Header");function j(a,c){__p&&__p();if(a!==void 0){a=b("bs_js_primitive").valFromOption(a).valueSeq().filter(function(a){return!(a.image_src==null)}).map(function(a,d,e){d=b("bs_belt_Option").getExn(b("bs_js_primitive").nullable_to_opt(a.image_src));return[d,a.fbId!==c]}).take(4).toArray();var d=a.length>3;d=d?a.filter(function(a){return a[1]}):a;return d.slice(0,3).map(function(a){return a[0]})}else return[]}function k(a,c,d){__p&&__p();if(a!==void 0){a=b("bs_js_primitive").valFromOption(a);var e=a.image_src;if(e==null){a=b("MercuryIDs").getParticipantIDFromFromThreadID(a.thread_id);if(a==null)return j(c,d);else{c=b("MessengerParticipants.bs").getNow(a);if(c==null)return[];else{d=c.image_src;if(d==null)return[];else return[d]}}}else return[e]}else return[]}function l(a){__p&&__p();if(a!==void 0){a=b("bs_js_primitive").valFromOption(a);if(a.is_canonical)return"";else{a=b("getGroupNameTooltipFromParticipantIDs").getGroupNameTooltipFromParticipantIDs(a.participants);if(a==null)return"";else return a}}else return""}function m(a){if(a!==void 0)return b("MessageRequestUtils").isMessageRequest(b("bs_js_primitive").valFromOption(a));else return!1}function n(a,c,d,e,f,g,j,n,o,p,q,r,s,t,u,v,w,x,y,z,A){__p&&__p();var B=s!==void 0?s:"";return[i[0],i[1],i[2],i[3],i[4],i[5],i[6],i[7],function(){__p&&__p();var i=k(r,p,t),s=r!==void 0?b("bs_js_primitive").nullable_to_opt(b("getPageIDFromThreadID")(b("bs_js_primitive").valFromOption(r).thread_id)):void 0,C=h._("Active now");if(r!==void 0){var D=b("bs_js_primitive").valFromOption(r);D=[D.thread_fbid,D.is_canonical]}else D=[null,!0];var E=D[1],F=D[0],G;if(p!==void 0){D=b("bs_js_primitive").valFromOption(p);var H=D.filter(function(b,a,c){return b.employee});G=D.count()>0&&H.count()===D.count()}else G=!1;var I=l(r);if(r!==void 0){H=b("bs_js_primitive").valFromOption(r).header_color;D=H==null?b("MessengerCustomColorUtils.bs").defaultColor(0):H}else D=b("MessengerCustomColorUtils.bs").defaultColor(0);H=c?D!==void 0?[0,D]:[1,""]:D!==void 0&&d?[[D],""]:[1,""];var J=H[1];D=H[0];var K="_69pt"+(c?" _2mgn":""),L=w?h._("New Message"):b("ReasonReact.bs").element(void 0,void 0,b("ChatThreadName.bs").make(r,B,I,t,"_2mgq",w,[]));H=s!==void 0;var M=m(r),N=M||!(r!==void 0&&!w)?null:b("React").createElement("div",{className:"_69ae"},b("React").createElement("div",{className:"_66n5 _1iti"},b("ReasonReact.bs").element(void 0,void 0,b("ChatVideoCallButton.bs").make(!1,H,void 0,void 0,D,r,t,void 0,[]))),b("React").createElement("div",{className:"_66n5 _1iti"},b("ReasonReact.bs").element(void 0,void 0,b("ChatVideoCallButton.bs").make(!0,H,o,q,D,r,t,void 0,[]))),b("React").createElement("div",{className:"_66n5"},b("ReasonReact.bs").element(void 0,void 0,b("ChatTabMenu.bs").make(r,t,g,u,p,x,a,e,d,c,w,y,D,[]))));M=b("bs_belt_Option").map(p,function(a){return b("bs_belt_Set").fromArray(b("bs_belt_Array").map(a.toArray(),function(a){return a[0]}),[b("ParticipantId.bs").cmp])});return b("ReasonReact.bs").element(void 0,void 0,b("bs_curry")._3(b("MessengerPresenceProvider.bs").make(M),void 0,void 0,function(a){a=r!==void 0?b("MessengerParticipantUtils.bs").findIntersection(t,a,b("bs_js_primitive").valFromOption(r)).length>0&&!z:!1;var c=s!==void 0||!a?null:b("React").createElement("div",{"aria-label":C,role:"presentation"},C);c=w?null:G?b("React").createElement("div",{className:"_69r-"},b("React").createElement("div",{className:"_1v1u"},b("ReasonReact.bs").element(void 0,void 0,b("ArchiveWarningReact.bs").make(G,[]))),c):c;return b("React").createElement("div",{className:K,style:{backgroundColor:J},onClick:n},b("React").createElement("div",{className:"_66n2"},w?null:b("ReasonReact.bs").element(void 0,void 0,b("FantaProfilePresence.bs").make(i,28,v!==void 0?!0:a,!0,B,I,J,e,f,E,F==null?void 0:b("bs_js_primitive").some(F),p,[])),b("React").createElement("div",{className:"_66n3"+(w?" _6dtv":"")},b("ReasonReact.bs").element(void 0,void 0,b("ChatDetailStack.bs").make(L,c,[])),N)),b("ReasonReact.bs").element(void 0,void 0,b("FantaCloseButton.bs").make(j,d,[])))}))},i[9],i[10],i[11],i[12]]}a=b("ReasonReact.bs").wrapReasonForJs(i,function(a){return n(a.hasBlockedMessages,a.highlightNewMessage,a.isFocused,a.isMultiCompany,a.isDoNotDisturb,b("bs_js_primitive").nullable_to_opt(a.membershipParticipants),a.onClose,a.onHeaderToggle,a.onRTCNuxCloseButtonClick,b("bs_js_primitive").nullable_to_opt(a.participants),a.rtcNuxShown,b("bs_js_primitive").nullable_to_opt(a.thread),a.threadHref,a.viewer,a.pageUnsubscribeStatus,b("bs_js_primitive").nullable_to_opt(a.pageIndicatorDescription),a.isNewMessageTab,a.showMessengerReportNux,a.uri,a.isMessengerOnlyUser,[])});c=28;f.component=i;f.profile_image_size=c;f.getUpTo3Images=j;f.getProfileImages=k;f.getTooltip=l;f.isThreadMessageRequest=m;f.make=n;f.jsComponent=a}),null);
__d("FantaChatHeaderContainer.react",["cx","AsyncRequest","Bootloader","ChatConfig","ChatTabHeaderContainer.react","FantaM4Header.bs","FantaTabActions","FantaTabSheetActions","MercuryIDs","MercuryIgnoredBlockedParticipants.bs","React","ShortProfiles","XGroupCallNuxController","immutable","performanceAbsoluteNow"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("FantaM4Header.bs").jsComponent;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=!1,this.state={rtcNuxShown:!1},this.$7=function(){var a=this.props.threadID;b("FantaTabSheetActions").openAddMoreFriendsSheet(a)}.bind(this),this.$4=function(a){this.props.onClose&&this.props.onClose(),a.preventDefault()}.bind(this),this.$5=function(a){var c=a.target,d=c&&c.classList&&c.classList.contains("button");c=c&&(c.tagName==="svg"||c.ownerSVGElement!=null);if(d||c)return;a.stopPropagation();b("FantaTabActions").minimizeTab(this.props.threadID)}.bind(this),this.$6=function(a){this.$3();var c=a.target;if(!c)return;(c.getAttribute("role")==="presentation"||c.classList&&(c.classList.contains("_15p6")||c.classList.contains("_2nlt")||c.classList.contains("_14lt")))&&(a.stopPropagation(),b("FantaTabActions").minimizeTab(this.props.threadID))}.bind(this),this.$3=function(){if(this.state.rtcNuxShown&&this.$1){this.setState({rtcNuxShown:!1});var a=b("XGroupCallNuxController").getURIBuilder().setString("action","dismiss").getURI();new(b("AsyncRequest"))(a).send()}}.bind(this),c}a.prototype.shouldComponentUpdate=function(a,b){var c=this.props,d=this.state;return c.threadHref!==a.threadHref||c.highlightNewMessage!==a.highlightNewMessage||c.isFocused!==a.isFocused||c.viewer!==a.viewer||c.threadID!==a.threadID||c.isLastGroupTab!==a.isLastGroupTab||c.thread!==a.thread||d.rtcNuxShown!==b.rtcNuxShown||c.customColor!==a.customColor||c.blockedIDs!==a.blockedIDs||!c.membershipParticipants&&!!a.membershipParticipants||!!c.membershipParticipants&&!!a.membershipParticipants&&!c.membershipParticipants.equals(a.membershipParticipants)||!c.participants&&!!a.participants||!!c.participants&&!!a.participants&&!c.participants.equals(a.participants)};a.prototype.componentDidMount=function(){var a=b("performanceAbsoluteNow")();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){b.markerPoint(c.FIRSTCHATTABOPEN_WWW,"mount_header",JSON.stringify({isNewMessageTab:this.props.isNewMessageTab,hasThread:!!this.props.thread}),0,a)}.bind(this),"FantaChatHeaderContainer.react");this.$1=!0;this.$2()};a.prototype.componentWillUnmount=function(){this.$3(),this.$1=!1};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.blockedIDs,d=a.composer,e=a.customColor,f=a.highlightNewMessage,g=a.isFocused,h=a.isNewMessageTab,j=a.membershipParticipants,k=a.pageIndicatorDescription,l=a.participants,m=a.thread,n=a.threadHref,o=a.threadID,p=a.uri;a=a.viewer;var q=this.state.rtcNuxShown,r=e?{color:e}:null;c=!!m&&b("MercuryIgnoredBlockedParticipants.bs").qualifiesAs(a,c,m);var s=!!m&&m.page_unsubscribe_status;if(b("ChatConfig").get("chat_tab_m4_header")){var t,u=b("MercuryIDs").getUserIDFromThreadID(o);u&&(t=b("ShortProfiles").getNow(u));u=t&&t.is_messenger_only;return b("React").createElement("div",{className:"clearfix titlebar"},b("React").createElement(i,{hasBlockedMessages:c,highlightNewMessage:f,isMessengerOnlyUser:u,isFocused:g,isMultiCompany:this.props.isMultiCompany,isDoNotDisturb:this.props.isDoNotDisturb,isNewMessageTab:!!h,membershipParticipants:j,onClose:this.$4,onHeaderToggle:this.$5,onRTCNuxCloseButtonClick:this.$3,pageUnsubscribeStatus:s,pageIndicatorDescription:k,participants:l,rtcNuxShown:q,showMessengerReportNux:!0,thread:m,threadHref:n,uri:p,viewer:a}))}return b("React").createElement("div",{className:"clearfix fbNubFlyoutTitlebar titlebar"+(e?" _1m34":""),style:r},b("React").createElement(b("ChatTabHeaderContainer.react"),{attachmentsShelf:document.createElement("div"),composer:d,hasBlockedMessages:c,href:n,isActive:g,isMultiCompany:this.props.isMultiCompany,isDoNotDisturb:this.props.isDoNotDisturb,isNewMessageTab:!!h,isRaised:!0,isTyping:!1,membershipParticipants:j,onClick:this.$6,onCloseClick:this.$4,onRTCNuxCloseButtonClick:this.$3,pageUnsubscribeStatus:s,participants:l,rtcNuxShown:q,sheetController:{openAddFriendsSheet:this.$7},showMessengerReportNux:!0,thread:m,threadID:o,uri:p,viewer:a}))};a.prototype.$2=function(){if(this.props.isLastGroupTab){var a=b("XGroupCallNuxController").getURIBuilder().setString("action","should_show").getURI();new(b("AsyncRequest"))(a).setHandler(function(a){a=a.payload.shouldShow;this.$1&&this.setState({rtcNuxShown:a})}.bind(this)).send()}};a.propTypes={blockedIDs:c.any,customColor:c.string,highlightNewMessage:c.bool,isFocused:c.bool.isRequired,isLastGroupTab:c.bool.isRequired,onClose:c.func.isRequired,thread:c.object,threadID:c.string.isRequired,uri:c.string,viewer:c.string.isRequired};e.exports=a}),null);
__d("FantaConversation.react",["Bootloader","ChatConversation.react","CurrentUser","EventProfiler","MercuryIDs","MessengerHotLikePreviewEvents","React","StickerInterfaces","StickersTypedLogger","SubscriptionsHandler","emptyFunction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(a){g.constructor.call(this,a),this.$4=function(a){this.props.threadID===a&&this.setState({likePreview:null})}.bind(this),this.$5=function(a,c){if(!a)return;new(b("StickersTypedLogger"))().setEvent("click_sticker").setPackid(a).setStickerid(c).log();b("Bootloader").loadModules(["StickersPackInTray","StickersActions","StickersStoreController"],function(c,d,e){c.onIsPackInTray(a,b("StickerInterfaces").MESSAGES,function(b){b.in_sticker_tray?(d.selectTrayPack(a),d.showStickerFlyout(this.props.threadID)):e.showStore(a)}.bind(this))}.bind(this),"FantaConversation.react")}.bind(this),this.state={likePreview:null},this.$1=new(b("SubscriptionsHandler"))()}a.prototype.shouldComponentUpdate=function(a,b){var c=this.props,d=this.state;return!c.messages.equals(a.messages)||c.threadID!==a.threadID||c.thread!==a.thread||d.likePreview!==b.likePreview};a.prototype.componentDidMount=function(){this.$2(),this.$3()};a.prototype.componentDidUpdate=function(){this.$3()};a.prototype.componentWillUnmount=function(){this.$1.release()};a.prototype.$3=function(){b("EventProfiler").informManualInteractionTimestamp(["MessageJewelListItem","ChatSideBarLink"],!0,"click")};a.prototype.$2=function(){this.$1.addSubscriptions(b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").START,function(a,b){this.props.threadID===b&&this.setState({likePreview:a})}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").STOP,this.$4),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").STOP_EMOJI,this.$4),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").REMOVE,this.$4))};a.prototype.render=function(){var a=this.props.messages,c=this.props,d=c.forGameChat,e=c.onLoadMoreMessages,f=c.thread;c=c.threadID;var g=this.state.likePreview,h=b("CurrentUser").getID();g&&(a=a.push(g));return f?b("React").createElement(b("ChatConversation.react"),{forGameChat:d,isCanonical:b("MercuryIDs").isCanonical(c),loadMoreMessages:e,maxBubbleWidth:181-this.props.scrollbarPadding,messages:a,onAttachmentLoad:function(){return this.props.onAttachmentLoad()}.bind(this),onMount:b("emptyFunction"),onStickerClick:this.$5,readReceipts:this.props.readReceipts,ref:"conversation",thread:f,threadID:c,viewer:h}):b("React").createElement("div",null)};a.prototype.getMessageList=function(){return this.refs.conversation&&this.refs.conversation.getMessageList()};a.propTypes={forGameChat:c.bool.isRequired,messages:c.object.isRequired,onLoadMoreMessages:c.func.isRequired,scrollbarPadding:c.number,thread:c.object,threadID:c.string.isRequired};e.exports=a}),null);
__d("FantaConversationScroller.react",["ix","cx","csx","fbt","Animation","Arbiter","BootloadedComponent.react","Bootloader","BootloadOnRender.react","ChatThread","ChatTypingIndicatorsWrapper.bs","CurrentUser","ErrorBoundary.react","Event","FantaConversation.react","FantaPageGreetingLoader.react","FantaTabActions","Grid.react","Image.react","JSResource","LazyComponent.react","Link.react","MercuryAttachment","MercuryConfig","MercuryIDs","MercuryLastMessageIndicator.react","MercuryQuickReply.react","MercuryShareAttachmentRenderLocations","MessengerHotLikePreviewEvents","MessengerParticipants.bs","MessengerQuickCamOrigins","MessengerTabsThreadSearchLoader","MessengerVideoAutoplayActions","MessengerVideoAutoplayStore","Parent","QE2Logger","React","ReactDOM","Scroll","ScrollBoundaryContain","Style","SubscriptionsHandler","TimeSlice","WebMessengerConstants","WorkBotLandingPageHelper","XUIButton.react","XUISpinner.react","immutable","asset","clearImmediate","emptyFunction","getElementPosition","getPageIDFromThreadID","gkx","isEventSupported","joinClasses","performanceAbsoluteNow","promiseDone","setImmediate","shallowEqual","throttle"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l=b("ChatThread").ChatThread,m=b("ChatTypingIndicatorsWrapper.bs").jsComponent,n=b("WorkBotLandingPageHelper").shouldShowBotLandingPage,o=b("Grid.react").GridItem;c=b("React").PropTypes;var p=15,q=null,r=20,s=1e3;function t(a){__p&&__p();if(q===null){var c=a.firstElementChild;if(c){b("Style").set(a,"overflow","scroll");var d=c.clientWidth;b("Style").set(a,"overflow","hidden");c=c.clientWidth;q=Math.max(c-d,0);b("Style").set(a,"overflow","")}else q=0}return q}d=babelHelpers.inherits(a,b("React").Component);k=d&&d.prototype;function a(a){__p&&__p();k.constructor.call(this,a),this.$9=[],this.state={loadingMessages:!this.props.isEmptyLocalThread,scrollbarPadding:q===null?p:q,hideLastMessageIndicator:!1,searchResults:null},this.$20=function(a){a=b("ReactDOM").findDOMNode(this.refs.scrollContainer);a&&(this.$21(),this.$22()&&!this.$23()&&!this.$3&&!this.props.hasFetchedAll&&!(this.state.searchResults&&this.state.searchResults.mid)&&(this.setState({loadingMessages:!0}),this.props.onLoadMoreMessages()),this.$24(),this.$10())}.bind(this),this.$16=function(){__p&&__p();if(!this.refs||this.state.loadingMessages||!this.props.thread){this.$9=[];return}var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer),c=b("getPageIDFromThreadID")(this.props.threadID);if(!a||!c){this.$9=[];return}var d=10,e,f;try{e=a.getBoundingClientRect(),f=this.refs.conversation?this.refs.conversation.getMessageList():null}catch(a){return}if(!f||!e)return;var g=[];this.$8.forEach(function(a){if(!f)return;var h=a.message_id,i=f.getMessageElement(h);if(i){i=i.getBoundingClientRect();i.top>e.top-d&&i.bottom<e.bottom+d&&(g.push(h),this.$9.includes(h)||b("Bootloader").loadModules(["MessengerAdsWebLogger","MNAdsLoggerEventEnum"],function(b,d){b.log(a.ad_client_token,a.ad_id,d.MESSAGE_SEEN_THREAD,!0,h,c)},"FantaConversationScroller.react"))}}.bind(this),this);this.$9=g}.bind(this),this.$26=function(){this.$1=null,b("FantaTabActions").scrollBottomChanged(this.props.threadID,this.$6,this.$27)}.bind(this),this.$27=function(){this.$28(!1),this.$18()}.bind(this),this.$29=function(){var a=b("performanceAbsoluteNow")();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){return b.markerEnd(c.FIRSTCHATTABOPEN_WWW,"SUCCESS",0,a)},"FantaConversationScroller.react")},this.$32=function(a){a=b("Parent").byClass(a.target,"._1dlq");a||this.props.onFocus&&this.props.onFocus()}.bind(this),this.$34=function(a){a.target&&a.target.classList&&a.target.classList.contains("_5wd4")&&(this.props.onFocus&&this.props.onFocus())}.bind(this),this.$6=!0}a.prototype.shouldComponentUpdate=function(a,c){var d=this.props,e=this.state;return d.hasFetchedAll!==a.hasFetchedAll||d.isFocused!==a.isFocused||!d.messages.equals(a.messages)||d.showContextBanner!==a.showContextBanner||d.readReceipts!==a.readReceipts||d.thread!==a.thread||d.threadID!==a.threadID||e.loadingMessages!==c.loadingMessages||e.hideLastMessageIndicator!==c.hideLastMessageIndicator||!b("shallowEqual")(e.searchResults,c.searchResults)||d.jumpToMessage!==a.jumpToMessage};a.prototype.componentDidMount=function(){__p&&__p();var a=b("performanceAbsoluteNow")();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){b.markerPoint(c.FIRSTCHATTABOPEN_WWW,"mount_conversation_scroller",JSON.stringify({messageSize:this.props.messages.size,hasThread:!!this.props.thread}),0,a)}.bind(this),"FantaConversationScroller.react");this.$7=new(b("SubscriptionsHandler"))();this.$11();this.$12();this.$13();b("MessengerVideoAutoplayActions").updateStore(this.props.threadID,this.$14());this.setState({scrollbarPadding:t(this.refs.scrollContainer),searchResults:this.$15()});this.$10=b("throttle")(this.$16,s);this.$8=this.props.messages.filter(function(a){return a.is_sponsored});this.$10();this.$17()};a.prototype.componentDidUpdate=function(a){__p&&__p();this.$13();if(this.$3){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer),d=this.$3||0;c=c.scrollHeight-d;this.scrollToPosition(c,!1);this.$3=null}if(!a.messages.equals(this.props.messages)){b("MessengerVideoAutoplayActions").updateStore(this.props.threadID,this.$14());d=a.messages.last();c=this.props.messages.last();if(d!==c&&c&&c.author){a=b("MercuryIDs").getUserIDFromParticipantID(c.author);a===b("CurrentUser").getID()&&(this.scrollToBottom(!1),this.$18())}}this.$19();this.$10()};a.prototype.componentWillUnmount=function(){this.$1&&b("clearImmediate")(this.$1),this.$7.release(),b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().updateThreadState(this.props.threadID,null)};a.prototype.UNSAFE_componentWillReceiveProps=function(a){__p&&__p();var c=this.state.loadingMessages&&a.messages.size>0&&!a.messages.equals(this.props.messages);if(c||a.hasFetchedAll||a.showContextBanner){this.setState({loadingMessages:!1});c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);var d=c.scrollHeight;c=b("Scroll").getTop(c);this.$3=d-c}this.$8=a.messages.filter(function(a){return a.is_sponsored})};a.prototype.$15=function(){return b("MessengerTabsThreadSearchLoader").isLoaded()?b("MessengerTabsThreadSearchLoader").getStoreEnforce().getThreadState(this.props.threadID):null};a.prototype.$17=function(){(b("gkx")("678588")||b("MercuryConfig").M3CRE)&&b("promiseDone")(b("MessengerTabsThreadSearchLoader").load(),function(a){var b=a.store;a.actions;this.$7.addSubscriptions(b.get().addListener("change",function(){return this.setState({searchResults:this.$15(),loadingMessages:!1})}.bind(this)))}.bind(this))};a.prototype.$13=function(a){a===void 0&&(a=!1),this.$6&&b("TimeSlice").guard(function(){this.scrollToBottom(a)}.bind(this),"post load chat animations",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()};a.prototype.renderGroupWave=function(){var a=this.props.thread;return b("MercuryIDs").isLocalThread(this.props.threadID)&&b("gkx")("678589")&&a&&!a.associated_object&&!a.is_canonical&&!a.thread_fbid?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement(b("XUISpinner.react"),{background:"light",className:"loading",size:"small"}),bootloadLoader:b("JSResource")("ChatWaveImage.react").__setRef("FantaConversationScroller.react"),thread:a,m4Thread:l!=null}):null};a.prototype.maybeRenderNullStateWave=function(){__p&&__p();var a=this.props,c=a.thread;a=a.threadID;if(!c||!c.is_canonical||c.timestamp)return null;b("QE2Logger").logExposureForUser("wave_in_www_null_state");if(!b("MercuryConfig").MNWNS)return null;c=b("MercuryIDs").getParticipantIDFromFromThreadID(a);c=c?b("MessengerParticipants.bs").getNow(c):null;c=c?c.short_name:null;return b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("MessengerNewWavePrompt.react").__setRef("FantaConversationScroller.react"),threadID:a,recipientName:c,entrypoint:"canonical_null_state"})};a.prototype.$24=function(){__p&&__p();var a=this.props.threadID,c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);if(!c)return;var d;try{c=c.getBoundingClientRect(),d=this.refs.conversation?this.refs.conversation.getMessageList():null}catch(a){return}if(!d||!c)return;var e=[],f=b("MessengerVideoAutoplayStore").getMessageIDs(a),g=f||this.$14()||b("immutable").List();g.map(function(a){var c=b("MercuryAttachment").getVideoElem(a,d);c&&e.push([a,c.getBoundingClientRect()])});e.length&&b("MessengerVideoAutoplayActions").onScroll(a,f?null:g,b("immutable").Map(e),c)};a.prototype.$14=function(){return this.props.messages.filter(function(a){return b("MercuryAttachment").isSingleVideoAttachment(a)||b("MercuryAttachment").isSharedVideoAttachmentMessage(a)}).reverse().map(function(a){return a.message_id})};a.prototype.$25=function(a,c){__p&&__p();var d=this.refs.conversation?this.refs.conversation.getMessageList():null;if(!d)return;var e=b("ReactDOM").findDOMNode(this.refs.scrollContainer),f=b("ReactDOM").findDOMNode(this.refs.conversation);d=d.getMessageComponent(a);a=b("ReactDOM").findDOMNode(d);if(!a||!f||!e)return;f=f.getBoundingClientRect().top;a=a.getBoundingClientRect().top;a=Math.abs(a-f)-e.getBoundingClientRect().height/2;this.$6=!1;this.scrollToPosition(Math.max(a,0),!1);b("CurrentUser").isWorkUser()&&d.highlightMessage();var g=c;g&&b("setImmediate")(function(){return g()})};a.prototype.scrollToBottom=function(a){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);c&&this.scrollToPosition(c.scrollHeight,a)};a.prototype.scrollToPosition=function(a,c){var d=b("ReactDOM").findDOMNode(this.refs.scrollContainer);this.$5&&this.$5.stop();c?this.$5=new(b("Animation"))(d).to("scrollTop",a).ease(b("Animation").ease.end).duration(400).go():b("Scroll").setTop(d,a)};a.prototype.$23=function(a){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);a=a===0?0:a||r;return b("Scroll").getTop(c)+c.clientHeight>=c.scrollHeight-a};a.prototype.$22=function(){var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer);return b("Scroll").getTop(a)<a.clientHeight};a.prototype.$18=function(){var a=this.$6;this.$23()?this.$6=!0:this.$6=!1;a!==this.$6&&(this.$1=b("setImmediate")(this.$26))};a.prototype.$11=function(){__p&&__p();var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer);if(!a)return;var c=b("isEventSupported")("mousewheel")?"mousewheel":b("isEventSupported")("wheel")?"wheel":"DOMMouseScroll",d=function(){this.$18()}.bind(this),e=function(){a.addEventListener(c,d,{passive:!0})},f=function(){a.removeEventListener(c,d,{passive:!0})};this.$7.addSubscriptions(b("Arbiter").subscribe("overflow-applied-to-body",function(){return this.$13()}.bind(this)),b("Event").listen(a,"mousedown",d),b("Event").listen(a,"mouseup",d),b("Event").listen(a,"mouseenter",e),b("Event").listen(a,"mouseleave",f),{cancel:f},b("Event").listen(a,"scroll",b("throttle")(this.$20,50)));e=b("ScrollBoundaryContain").applyToElem(a);e&&this.$7.addSubscriptions(e)};a.prototype.$12=function(){this.$7.addSubscriptions(b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").START,function(a,b){this.props.threadID===b&&(this.$28(!1),clearInterval(this.$4),this.$4=setInterval(function(){this.$28(!1)}.bind(this),50))}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").FINISH_ANIMATION,function(a){clearInterval(this.$4)}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").FINISH_EMOJI_ANIMATION,function(a){clearInterval(this.$4)}.bind(this)),b("MessengerHotLikePreviewEvents").addListener(b("MessengerHotLikePreviewEvents").REMOVE,function(a){this.props.threadID===a&&clearInterval(this.$4)}.bind(this)))};a.prototype.$30=function(){return b("CurrentUser").isWorkUser()&&b("gkx")("678590")?n(this.props.messages):this.props.messages.size===0};a.prototype.$31=function(){return b("CurrentUser").isWorkUser()&&b("gkx")("678590")?n(this.props.messages):!1};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.forGameChat,d=a.hasFetchedAll,e=a.isEmptyLocalThread,f=a.messages,g=a.showContextBanner,h=a.thread;a=a.threadID;var i=b("CurrentUser").getID();e=e||d||g;d=this.state.loadingMessages||!h?b("React").createElement("div",{className:"_1xdl"},b("React").createElement(b("XUISpinner.react"),{background:"light",className:"loading",size:"small"})):null;d||(this.$29(),this.$29=b("emptyFunction"));g=function(){return this.$13()}.bind(this);var k=this.$30()?b("React").createElement(b("FantaPageGreetingLoader.react"),{thread:h,threadID:a}):null;e=e?b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("MessengerContextBannerContainer.react").__setRef("FantaConversationScroller.react"),isContinuation:!1,location:b("MercuryShareAttachmentRenderLocations").CHAT,viewer:i,thread:h,threadID:a}):null;var n=b("React").createElement("div",{className:b("joinClasses")("accessible_elem","_2kwv")},j._("Chat Conversation Start")),p=b("React").createElement("div",{className:b("joinClasses")("accessible_elem","_2kwv")},j._("Chat Conversation End")),q=null,r=this.state.searchResults;if(r&&r.messages){var s=j._("Load more...");q=b("React").createElement(b("React").Fragment,null,r.upExhausted?null:b("React").createElement(b("XUIButton.react"),{className:"_41jf",label:s,onClick:function(){return b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().getMoreSearchContext(b("WebMessengerConstants").MORE_SEARCH_CONTEXT_UP,this.props.threadID)}.bind(this),type:"primary",use:"default"}),b("React").createElement(b("FantaConversation.react"),{forGameChat:c,onAttachmentLoad:g,scrollbarPadding:this.state.scrollbarPadding,ref:"conversation",messages:r.messages,onLoadMoreMessages:b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().getMoreSearchContext,hasFetchedAll:this.props.hasFetchedAll,isFocused:this.props.isFocused,onFocus:this.props.onFocus,readReceipts:this.props.readReceipts,showContextBanner:this.props.showContextBanner,thread:this.props.thread,threadID:this.props.threadID}),r.downExhausted?null:b("React").createElement(b("XUIButton.react"),{className:"_41jf",label:s,onClick:function(){return b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().getMoreSearchContext(b("WebMessengerConstants").MORE_SEARCH_CONTEXT_DOWN,this.props.threadID)}.bind(this),type:"primary",use:"default"}),b("React").createElement(m,{threadID:a,indicatorClass:void 0,indicatorsWillShow:b("emptyFunction"),indicatorsDidShow:function(){return this.setState({hideLastMessageIndicator:!0},function(){this.$13(!0)}.bind(this))}.bind(this),indicatorsDidHide:function(){return this.setState({hideLastMessageIndicator:!1})}.bind(this),rootClassName:void 0,viewer:i}))}else q=b("React").createElement(b("React").Fragment,null,b("React").createElement(b("FantaConversation.react"),babelHelpers["extends"]({forGameChat:c,onAttachmentLoad:g,scrollbarPadding:this.state.scrollbarPadding,ref:"conversation"},this.props)),b("React").createElement(b("MercuryQuickReply.react"),{lastMessage:f.size>0?f.last():void 0,threadID:a,quickReplyDidShow:function(){return this.$13(!0)}.bind(this),viewer:i,quickCamOriginLocation:b("MessengerQuickCamOrigins").CHAT_TAB}),b("React").createElement(m,{threadID:a,indicatorClass:void 0,indicatorsWillShow:b("emptyFunction"),indicatorsDidShow:function(){return this.setState({hideLastMessageIndicator:!0},function(){this.$13(!0)}.bind(this))}.bind(this),indicatorsDidHide:function(){return this.setState({hideLastMessageIndicator:!1})}.bind(this),rootClassName:void 0,viewer:i}),this.renderGroupWave(),this.maybeRenderNullStateWave(),b("React").createElement(b("MercuryLastMessageIndicator.react"),{isTyping:this.state.hideLastMessageIndicator,indicatorDidShow:function(){this.$13(!0)}.bind(this),indicatorWillShow:b("emptyFunction"),lastMessage:f.size>0?f.last():null,readReceipts:this.props.readReceipts,thread:h,threadID:a}));r=b("React").createElement("div",{className:"_1xdm"+(d?" _1xdw":"")},b("React").createElement("div",{className:"_1xdx"},b("React").createElement("div",{className:"_1xe8"})),n,e,d,b("React").createElement("div",{style:f.size>0?{height:"176px"}:d?{height:"168px"}:{height:"192px"},className:"_1xdm"},this.$31()?null:q,b("gkx")("678591")&&b("React").createElement(b("ErrorBoundary.react"),{project:"omnim"},b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("OmniMSuggestionsContainer.react").__setRef("FantaConversationScroller.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{threadID:this.props.threadID,trackBottom:function(){return this.$13(!0)}.bind(this)})}))),p);return l!=null?b("React").createElement(l,{onClick:this.$32,spacerContent:b("React").createElement(b("React").Fragment,null,n,e,k,d),scrollRef:function(a){this.refs.scrollContainer=a}.bind(this)},q,b("gkx")("678591")&&b("React").createElement(b("ErrorBoundary.react"),{project:"omnim"},b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("OmniMSuggestionsContainer.react").__setRef("FantaConversationScroller.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{threadID:this.props.threadID,trackBottom:function(){return this.$13(!0)}.bind(this)})})),p,this.$33()):b("React").createElement("div",{className:"_2v5j"},b("React").createElement("div",{className:"fbNubFlyoutBody scrollable",onClick:this.$34,ref:"scrollContainer",role:"button",tabIndex:"0"},b("React").createElement("div",{className:"fbNubFlyoutBodyContent"},k,b("React").createElement(b("Grid.react"),{className:"conversationContainer",role:"log",cols:1},b("React").createElement(o,{alignv:"bottom"},r)))),this.$33())};a.prototype.$33=function(){return this.state.searchResults&&this.state.searchResults.messages?b("React").createElement(b("Link.react"),{className:"_2llh",onClick:function(){b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().updateThreadState(this.props.threadID,null),this.$6=!0}.bind(this)},b("React").createElement(b("Image.react"),{className:"_2llt",src:g("415098")})):null};a.prototype.$19=function(){var a=this.props.jumpToMessage;if(!a)return;this.props.messages.some(function(b){return b.message_id===a})||this.state.searchResults&&this.state.searchResults.messages&&this.state.searchResults.messages.some(function(b){return b.message_id===a})?this.$25(a,function(){return b("FantaTabActions").wipeJumpToMessage(this.props.threadID)}.bind(this)):b("MessengerTabsThreadSearchLoader").isLoaded()&&b("MessengerTabsThreadSearchLoader").getActionsEnforce().updateThreadState(this.props.threadID,a)};a.prototype.$21=function(){var a=b("ReactDOM").findDOMNode(this.refs.scrollContainer),c=b("getElementPosition")(a);b("Arbiter").inform("chatScrolled/"+this.props.threadID,{scrollTop:b("Scroll").getTop(a),top:c.y,viewHeight:c.height})};a.prototype.$28=function(a){var c=b("ReactDOM").findDOMNode(this.refs.scrollContainer);c&&this.$35(c.scrollHeight,a)};a.prototype.$35=function(a,c){var d=b("ReactDOM").findDOMNode(this.refs.scrollContainer);this.$5&&this.$5.stop();c===!0?this.$5=new(b("Animation"))(d).to("scrollTop",a).ease(b("Animation").ease.end).duration(400).go():b("Scroll").setTop(d,a)};a.propTypes={forGameChat:c.bool.isRequired,hasFetchedAll:c.bool.isRequired,isEmptyLocalThread:c.bool.isRequired,isFocused:c.bool.isRequired,messages:c.object.isRequired,onFocus:c.func,onLoadMoreMessages:c.func.isRequired,showContextBanner:c.bool,thread:c.object,threadID:c.string.isRequired,jumpToMessage:c.string};e.exports=a}),null);
__d("FantaDragAndDrop.react",["Bootloader","JSResource","MercuryShareAttachmentRenderLocations","MessengerEnvironment","Placeholder.react","React","emptyFunction","ifRequired","lazyLoadComponent"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=960;c=b("React").PropTypes;var i=b("lazyLoadComponent")(b("JSResource")("MercurySharePreview.react").__setRef("FantaDragAndDrop.react"));d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){__p&&__p();var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$2=function(a){var b=this.props.composer;this.$5(function(c){c.removeSharePreview(a,b)})}.bind(this),this.$3=function(a,b){var c=this.props.composer;this.$5(function(d){d.loadedShareData(a,b,c)})}.bind(this),this.$4=function(a){var b=this.props.composer;this.$5(function(c){c.loadingShareData(a,b)})}.bind(this),b}a.prototype.componentDidMount=function(){b("MessengerEnvironment").messengerui?b("Bootloader").loadModules(["MessengerActions"],b("emptyFunction"),"FantaDragAndDrop.react"):b("Bootloader").loadModules(["FantaMessageActions"],b("emptyFunction"),"FantaDragAndDrop.react")};a.prototype.shouldComponentUpdate=function(a){var b=this.props,c=b.composer,d=a.composer;c=c.sharePreview;d=d.sharePreview;return b.threadID!==a.threadID||!!(!c&&d)||!!(c&&d&&!c.equals(d))};a.prototype.render=function(){var a=this.props,c=a.composer;a=a.threadID;c=c.sharePreview;var d=c.share;c=c.uri;return b("React").createElement("div",{className:"fbNubFlyoutAttachments"},b("React").createElement("div",{className:"chatAttachmentShelf"},d||c?b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",null)},b("React").createElement(i,{onClose:this.$2,onLoaded:this.$3,onLoading:this.$4,threadID:a,imageSize:{width:h,height:h},location:b("MercuryShareAttachmentRenderLocations").CHAT_PREVIEW,share:d,uri:c})):null))};a.prototype.$5=function(a){b("MessengerEnvironment").messengerui?b("ifRequired")("MessengerActions",function(b){a(b)},function(){b("Bootloader").loadModules(["MessengerActions"],function(b){a(b)},"FantaDragAndDrop.react")}):b("ifRequired")("FantaMessageActions",function(b){a(b)},function(){b("Bootloader").loadModules(["FantaMessageActions"],function(b){a(b)},"FantaDragAndDrop.react")})};a.propTypes={composer:c.object.isRequired,threadID:c.string.isRequired};e.exports=a}),null);
__d("FantaMercuryTabOverflowBootloader.react",["BootloadOnRender.react","ChatConfig","JSResource","LazyComponent.react","React","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){var a=b("ChatConfig").get("chat_tab_m4_header")?b("JSResource")("FantaM4TabOverflow.react").__setRef("FantaMercuryTabOverflowBootloader.react"):b("JSResource")("FantaMercuryTabOverflow.react").__setRef("FantaMercuryTabOverflowBootloader.react");return b("React").createElement(b("BootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{items:this.props.items,tabContents:this.props.tabContents}),loader:a,placeholder:b("React").createElement("div",null)})};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("FantaTab.react",["cx","EventProfiler","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.$1=!1,b}a.prototype.componentDidMount=function(){b("EventProfiler").informManualInteractionTimestamp(["MessageJewelListItem","ChatSideBarLink"],!0,"click")};a.prototype.render=function(){var a=this.props,c=a.isFocused,d=a.isLastTab,e=a.isLastTabOfType,f=a.MainComponent,g=a.messengerState,h=a.MinimizedComponent,i=a.raisedTabCount,j=a.tab,k=a.tabContent;a=a.forGameChat;h=j.isMinimized?h:f;f=j.id+(j.isMinimized?"-minimized":"-maximized");var l=this.$1&&!j.isMinimized;this.$1=j.isMinimized;return b("React").createElement("div",{className:"_5qi9 _5qib"+(this.props.isFocused?" _5qic":"")+(j.isMinimized?" _3001":"")},b("React").createElement(h,{isFocused:c,isHovered:j.isHovered||l,isLastTab:d,isLastTabOfType:e,key:f,messengerState:g,raisedTabCount:i,tab:j,tabContent:k,forGameChat:a}))};e.exports=a}),null);
__d("FantaTabGroup.react",["cx","FantaTab.react","React"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.shouldComponentUpdate=function(a){return!this.props.tabGroup.equals(a.tabGroup)||this.props.messengerState!==a.messengerState||!!(!this.props.tabContents&&a.tabContents)||!!(this.props.tabContents&&a.tabContents&&!this.props.tabContents.equals(a.tabContents))};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.isLastOfTypeChecker,d=a.MainComponent,e=a.messengerState,f=a.MinimizedComponent,g=a.OverflowComponent,h=a.tabContents;a=a.tabGroup;var i=a.focusedTabID,j=a.getRaisedandUnraisedTabs(),k=j.raisedTabs;j=j.unraisedTabs;var l;c&&(l=k.findLastKey(function(a){return c(a)&&a.id}));a=a.allowedRaisedTabs===0?null:this.$1(j,g);var m=k.count();return b("React").createElement("div",{className:"_59v1"},a,k.map(function(a){return b("React").createElement(b("FantaTab.react"),{forGameChat:!1,isFocused:a.id===i,isLastTab:a===k.last(),isLastTabOfType:a.id===l,key:a.id,messengerState:e,MainComponent:d,MinimizedComponent:f,raisedTabCount:m,tab:a,tabContent:h&&h.get(a.id)})}).toArray())};a.prototype.$1=function(a,c){return!a.isEmpty()?b("React").createElement("div",{className:"_1kws"},b("React").createElement(c,{items:a,tabContents:this.props.tabContents})):null};function a(){h.apply(this,arguments)}a.propTypes={MainComponent:c.func.isRequired,messengerState:c.array,MinimizedComponent:c.func.isRequired,OverflowComponent:c.func.isRequired,tabContents:c.object,tabGroup:c.object.isRequired};e.exports=a}),null);
__d("FantaPendingActions.react",["Bootloader","BootloadOnRender.react","FantaTabActions","JSResource","LazyComponent.react","MercuryThreadActions","MessengerMessageRequestsTypedLogger","MessageRequestUtils","MessagingTag","React","MercuryIDs","CurrentUser"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("MercuryThreadActions").get();c=babelHelpers.inherits(a,b("React").PureComponent);g=c&&c.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$3=function(){var a=this.props.thread;a=!!a&&b("MessageRequestUtils").isFiltered(a);var c=b("CurrentUser").getID();c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,c);new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_delete_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(a?"other":"pending").setThreadKey(c).setEntryPoint(null).log()}.bind(this),this.$4=function(a){var c=this.props.thread;c=!!c&&b("MessageRequestUtils").isFiltered(c);var d=b("CurrentUser").getID();d=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,d);a==="hide"&&new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_cancel").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(c?"other":"pending").setThreadKey(d).setEntryPoint("inbox_banner").log()}.bind(this),this.$1=function(){__p&&__p();var a=this.props,c=a.thread,d=a.threadID;a=!!c&&b("MessageRequestUtils").isFiltered(c);var e=b("CurrentUser").getID();e=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,e);if(a)b("Bootloader").loadModules(["WebMessengerDeleteThreadDialog"],function(a){a.show(d,this.$3,this.$4,function(){return b("FantaTabActions").closeTab(d)})}.bind(this),"FantaPendingActions.react");else{var f=b("MercuryIDs").isGroupChat(d);b("Bootloader").loadModules(["WebMessengerDeclineMRDialog"],function(a){a.show(c.folder,d,function(){return b("FantaTabActions").closeTab(d)},f)},"FantaPendingActions.react")}new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_decline_attempt").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(a?"other":"pending").setThreadKey(e).setEntryPoint(null).log()}.bind(this),this.$2=function(){var a=this.props.thread;a=!!a&&b("MessageRequestUtils").isFiltered(a);var c=b("CurrentUser").getID();c=b("MercuryIDs").getThreadKeyfromThreadIDUserID(this.props.threadID,c);h.changeFolder(this.props.threadID,b("MessagingTag").INBOX);new(b("MessengerMessageRequestsTypedLogger"))().setAction("message_requests_accept_request").setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(this.props.threadID)).setSurface("thread").setFolderType(a?"other":"pending").setThreadKey(c).setEntryPoint(null).log()}.bind(this),c}a.prototype.render=function(){var a=this.props.thread;a=!!a&&b("MessageRequestUtils").isFiltered(a);return b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("ChatPendingActions.react").__setRef("FantaPendingActions.react"),placeholder:b("React").createElement("div",{style:{height:27}}),component:b("React").createElement(b("LazyComponent.react"),{isFiltered:a,onDeleteClick:this.$1,onReplyClick:this.$2})})};e.exports=a}),null);
__d("FantaTabComposer.react",["ChatTabComposerContainer.react","MessengerState.bs","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("React").Component);g=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=g.constructor).call.apply(a,[this].concat(d)),this.$2=function(a){this.$1=a}.bind(this),b}a.prototype.componentDidMount=function(){var a=this.props.participants;this.props.isFocused&&a.length>0&&!this.props.isEmptyLocalThread&&this.focusInput()};a.prototype.componentDidUpdate=function(a){this.props.isFocused&&this.props.isFocused!==a.isFocused&&!this.props.isEmptyLocalThread&&this.focusInput()};a.prototype.shouldComponentUpdate=function(a){var b=this.props;return!b.composer.equals(a.composer)||b.disableInput!==a.disableInput||!b.fileUploader&&!!a.fileUploader||b.fileUploader&&!b.fileUploader.equals(a.fileUploader)||b.isEmptyLocalThread!==a.isEmptyLocalThread||b.isFocused!==a.isFocused||b.isNewEmptyLocalThread!==a.isNewEmptyLocalThread||b.threadID!==a.threadID||b.viewer!==a.viewer||b.forGameChat!==a.forGameChat||b.participants.length!==a.participants.length};a.prototype.render=function(){var a=this.props,c=a.participants,d=a.threadID,e=a.viewer,f=a.isFocused;return c.length===0?b("React").createElement("div",null):b("React").createElement(b("MessengerState.bs").jsComponent,{fbid:e},function(a){return b("React").createElement(b("ChatTabComposerContainer.react"),{composer:this.props.composer,disableInput:this.props.disableInput,fileUploader:this.props.fileUploader,isFocused:f,onEscape:this.props.onEscape,onSelectSticker:this.props.onSelectSticker,onSendHotLike:this.props.onSendHotLike,onSendPhoto:this.props.onSendPhoto,onTab:this.props.onTab,onSendMessage:this.props.onSendMessage,isNewEmptyLocalThread:this.props.isNewEmptyLocalThread,ref:this.$2,thread:b("MessengerState.bs").threads(a)[d],threadID:d,viewer:e,forGameChat:this.props.forGameChat})}.bind(this))};a.prototype.focusInput=function(){this.$1&&this.$1.focusInput()};a.prototype.hasEmptyInput=function(){var a=this.$1;return!a?!1:a.hasEmptyInput()};e.exports=a}),null);
__d("FantaTabSheetPlaceholder.react",["cx","React","XUISpinner.react"],(function(a,b,c,d,e,f,g){"use strict";a=function(){return b("React").createElement("div",{className:"_w_z"},b("React").createElement(b("XUISpinner.react"),null))};e.exports=a}),null);
__d("FantaTabSheet.react",["cx","BootloadedComponent.react","CurrentUser","FantaTabSheetPlaceholder.react","JSResource","LazyComponent.react","MercuryIDs","MercurySheetPolicy","MessengerParticipants.bs","MessengerState.bs","Placeholder.react","React","ReasonBootloadOnRender.react","ReasonResource","emptyFunction","lazyLoadComponent"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("lazyLoadComponent")(b("JSResource")("ChatGroupsSyncTabSheet.react").__setRef("FantaTabSheet.react")),j=b("lazyLoadComponent")(b("JSResource")("ChatGroupNameComposerTabSheet.react").__setRef("FantaTabSheet.react"));c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.shouldComponentUpdate=function(a){var b=this.props;return b.threadID!==a.threadID||!b.tabContent.equals(a.tabContent)};a.prototype.maybeRenderMontage=function(){var a=this.props,c=a.threadID;a=a.tabContent;return a.isMontageOpen?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatMontageSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:"Montage",threadID:c,onResize:b("emptyFunction")}):null};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.threadID,d=a.tabContent;a=a.composerComponent;var e=d.loggingID,f=d.openSheet,g=d.privacyController,h=d.thread,k=d.typeahead,l;switch(f){case b("MercurySheetPolicy").sheets.ChatThreadIsMutedTabSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetChatThreadIsMuted.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatNameConversationTabSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetNameConversation.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement(b("FantaTabSheetPlaceholder.react"),null),key:f,thread:h,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatUserBlockedTabSheet:var m=b("MercuryIDs").getUserIDFromThreadID(c);if(m){m=b("MessengerParticipants.bs").getNow(b("MercuryIDs").getParticipantIDFromUserID(m));m&&g&&(l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUserBlockedTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),gender:m.gender,key:f,privacyActionController:g,shortName:m.short_name}))}break;case b("MercurySheetPolicy").sheets.ChatOfflineTabSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetOffline.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f,privacyController:g,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatReadOnlyTabSheet:case b("MercurySheetPolicy").sheets.ChatReadOnlyPermanentTabSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetReadOnly.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f,threadID:c});break;case b("MercurySheetPolicy").sheets.FantaAddFriendsSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetAddFriends.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement(b("FantaTabSheetPlaceholder.react"),null),key:f,loggingID:e,thread:h,threadID:c,typeahead:k,composerComponent:a,tabContent:d});break;case b("MercurySheetPolicy").sheets.FantaAddMoreFriendsSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetAddMoreFriends.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement(b("FantaTabSheetPlaceholder.react"),null),key:f,loggingID:e,thread:h,threadID:c,typeahead:k});break;case b("MercurySheetPolicy").sheets.ChatThreadIsMessageBlockedSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaTabSheetMessageBlocked.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f,participants:d.participants,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatUserFocusSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUserFocusSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f,thread:h,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatUserFocusBypassSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUserFocusBypassSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f});break;case b("MercurySheetPolicy").sheets.ChatUploadWarningTabSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatUploadWarningTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f});break;case b("MercurySheetPolicy").sheets.ChatNoRecipientsTabSheet:b("MercuryIDs").isCanonical(c)||(l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatNoRecipientsTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f}));break;case b("MercurySheetPolicy").sheets.ChatNewMessagesTabSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaNewMessagesTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatEmployeeAwaySheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatEmployeeAwaySheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f});break;case b("MercurySheetPolicy").sheets.ChatEventReminderTabSheet:l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FantaEventReminderTabSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f,threadID:c});break;case b("MercurySheetPolicy").sheets.ChatAppointmentBanner:if(h){m=b("MessengerState.bs").getCurrentlyLoadedMessages(b("CurrentUser").getID(),c);l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatAppointmentBannerRoot.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),pageID:h.other_user_fbid,userID:b("CurrentUser").getID(),count:100,messageList:m,appointmentBannerDidUpdate:b("emptyFunction"),key:f,threadID:c})}break;case b("MercurySheetPolicy").sheets.ChatJoinCallSheet:if(h){g=h.rtc_call_data;e=h.thread_fbid;l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatJoinCallSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f,rtcCallData:g,threadFBID:e})}break;case b("MercurySheetPolicy").sheets.ChatRoomAssociatedObjectSheet:if(h){k=h.associated_object;l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("ChatRoomAssociatedObjectSheet.react").__setRef("FantaTabSheet.react"),bootloadPlaceholder:b("React").createElement("div",null),key:f,associatedObject:k})}break;case b("MercurySheetPolicy").sheets.ChatMentorshipProgramSheet:h&&(l=b("React").createElement(b("ReasonBootloadOnRender.react"),{component:b("React").createElement(b("LazyComponent.react"),{thread:h}),loader:b("ReasonResource")(b("JSResource")("MentorshipProgramSheet.bs").__setRef("FantaTabSheet.react")),placeholder:b("React").createElement("div",null)}));break;case b("MercurySheetPolicy").sheets.ChatGroupsSyncTabSheet:h&&h.work_associated_group&&(l=b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",null),key:f},b("React").createElement(i,{group:h.work_associated_group,imageURL:h.image_src,name:h.name})));break;case b("MercurySheetPolicy").sheets.ChatGroupNameComposerTabSheet:l=b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",null),key:f},b("React").createElement(j,{threadID:c,composerComponent:a}));break}d=this.maybeRenderMontage();if(l)return b("React").createElement("div",{className:"_1sk5"},b("React").createElement("div",{className:"_1sk6"},l));else if(d)return d;return null};function a(){h.apply(this,arguments)}a.propTypes={threadID:c.string.isRequired,tabContent:c.object.isRequired};e.exports=a}),null);
__d("FantaTabMain.react",["cssVar","cx","fbt","invariant","Bootloader","ChatBehavior","ChatConfig","ChatTabBlinking","CurrentUser","DragDropTarget","Event","FantaChatHeaderContainer.react","FantaConversationScroller.react","FantaDispatcher","FantaDragAndDrop.react","FantaMessageActions","FantaPendingActions.react","FantaTabActions","FantaTabComposer.react","FantaTabSheet.react","FantaWebDriverIDs","FBIDCheck","JSResource","Keys","MercuryIDs","MessageRequestUtils","MessagingTagConstants","MessengerBotMenuDataFetcher","MessengerCustomColorUtils.bs","MessengerParticipants.bs","MessengerParticipantUtils.bs","MessengerPresenceProvider.bs","MessengerState.bs","MNCommercePageSetting","Parent","Placeholder.react","React","ReactDOM","ShortProfiles","SimpleXUIDialog","TrackingNodes","WorkBotLandingPageHelper","WorkChatAvailabilityStatusLoader","WorkChatUtils","WorkFileUploadsGating","XUISpinner.react","clearTimeout","convertMIGColorToFIGColor","getPageIDFromThreadID","getVendorPrefixedEventName","gkx","immutable","joinClasses","lazyLoadComponent","performanceAbsoluteNow","promiseDone","setTimeout","throttle"],(function(a,b,c,d,e,f,g,h,i,j){"use strict";__p&&__p();var k,l=b("MessengerPresenceProvider.bs").jsComponent,m=b("WorkBotLandingPageHelper").shouldShowBotLandingPage,n=b("lazyLoadComponent")(b("JSResource")("MarketplaceMessengerContextBanner.react").__setRef("FantaTabMain.react")),o=b("lazyLoadComponent")(b("JSResource")("ChatJoinableInterstitialPreview.react").__setRef("FantaTabMain.react")),p=b("lazyLoadComponent")(b("JSResource")("P2PChatThreadBannerContainer.react").__setRef("FantaTabMain.react")),q=b("lazyLoadComponent")(b("JSResource")("MessengerGameBotPlayButton.react").__setRef("FantaTabMain.react")),r=b("lazyLoadComponent")(b("JSResource")("FantaPageComposerNullState.react").__setRef("FantaTabMain.react")),s=/\D+/g,t=b("ChatConfig").get("compact.content.m4");c=b("React").PropTypes;var u=function(a){a=b("MercuryIDs").getUserIDFromThreadID(a.tab.id);return a&&b("gkx")("678573")&&b("WorkChatAvailabilityStatusLoader").isLoaded()?b("WorkChatAvailabilityStatusLoader").getStoreEnforce().getIsDoNotDisturb(a):!1};function v(a,c,d){__p&&__p();var e={};if(b("ChatConfig").getBool("dark_test_gradients")){c?e.backgroundImage="linear-gradient("+c+", "+c+")":e.backgroundImage="linear-gradient("+d+", "+d+")";return e}if(a){c?e.backgroundColor=c:e.backgroundColor=d;if(a.length&&a.length>0)if(a.length===1)e.backgroundColor=a[0];else if(a.length===2)e.backgroundImage="linear-gradient("+a[0]+", "+a[1]+")";else{var f=a.length,g=100/(f-1);f=a.map(function(a,b){return a+" "+b*g+"%"}).join(", ");e.backgroundImage="linear-gradient("+f+")"}}else c?e.backgroundColor=c:e.backgroundColor=d;return e}d=babelHelpers.inherits(a,b("React").Component);k=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=k.constructor).call.apply(a,[this].concat(e)),this.$10=null,this.state={closing:!1,disableInput:!1,isDoNotDisturb:u(this.props)},this.$23=function(a){__p&&__p();var c=!!b("Parent").byClass(a.target,"fantaTabMain-"+this.props.tab.id);a=!!b("Parent").byClass(a.relatedTarget,"fantaTabMain-"+this.props.tab.id);if(!c||!a){if(this.$9){b("clearTimeout")(this.$9);this.$9=null;return}b("FantaTabActions").hoveredTab(this.props.tab.id)}}.bind(this),this.$24=function(a){var c=!!b("Parent").byClass(a.target,"fantaTabMain-"+this.props.tab.id);a=!!b("Parent").byClass(a.relatedTarget,"fantaTabMain-"+this.props.tab.id);(!c||!a)&&(this.$9&&b("clearTimeout")(this.$9),this.$9=b("setTimeout")(function(){this.$9=null,b("FantaTabActions").unhoveredTab(this.props.tab.id)}.bind(this),500))}.bind(this),this.$21=function(a){var c=!!b("Parent").byClass(a.target,"fantaTabMain-"+this.props.tab.id),d=!!b("Parent").byClass(a.relatedTarget,"fantaTabMain-"+this.props.tab.id);(!c||!d)&&(!a.relatedTarget||!a.target?this.$7=b("setTimeout")(function(){this.$7=null,this.$25(this.props.tab.id)}.bind(this),100):this.$25(this.props.tab.id))}.bind(this),this.$22=function(a){if(this.$7){b("clearTimeout")(this.$7);this.$7=null;return}var c=!!b("Parent").byClass(a.target,"fantaTabMain-"+this.props.tab.id),d=!!b("Parent").byClass(a.relatedTarget,"fantaTabMain-"+this.props.tab.id);a=a.target;a&&a.classList&&(a.classList.contains("_3olu")||a.classList.contains("_61td")||a.classList.contains("_40qq")||a.classList.contains("_4zs3"))||(!c||!d)&&(b("FantaDispatcher").isDispatching()||b("FantaTabActions").focusTab(this.props.tab.id))}.bind(this),this.$27=function(a){b("FantaMessageActions").linkPreview(this.props.tab.id,a)}.bind(this),this.$26=function(a){var c=this.props.tabContent;c=c||{};c=c.composer;var d=this.props.tab.id;c&&b("FantaMessageActions").prepareFilesForSend(d,a,c)}.bind(this),this.$18=function(a){a.keyCode===b("Keys").ESC&&(this.$2(!0),a.preventDefault(),a.stopPropagation())}.bind(this),this.$19=function(a){a.keyCode===b("Keys").TAB&&this.$20(a)}.bind(this),this.$20=function(a){var b=this.props.raisedTabCount;b>1&&(a.preventDefault(),this.$3(a.ctrlKey,a.shiftKey))}.bind(this),this.$2=function(a){var c=this.props,d=c.tab;c=c.tabContent;!c||c&&c.composer.text.length===0&&!this.$28()?(this.$29(),a?b("FantaTabActions").closeAndTabNext(d.id):b("FantaTabActions").closeTab(d.id)):this.$30();this.$31()}.bind(this),c}a.prototype.UNSAFE_componentWillMount=function(){this.$2=b("throttle")(this.$2,100),this.$3=b("throttle")(this.$3,100)};a.prototype.componentDidMount=function(){var a=b("performanceAbsoluteNow")();b("Bootloader").loadModules(["QuickPerformanceLogger","MessengerWebQuickLogModule"],function(b,c){b.markerPoint(c.FIRSTCHATTABOPEN_WWW,"mount_fanta_main",JSON.stringify({messageSize:this.props.messages?this.props.messages.size:0,hasThread:!!this.props.thread}),0,a)}.bind(this),"FantaTabMain.react");this.$11();this.$12();this.$13(this.props.tab.id);this.$14();this.$15();this.$16()};a.prototype.componentDidUpdate=function(a){this.$12();if(b("gkx")("678573")&&b("WorkChatAvailabilityStatusLoader").isLoaded()&&a.thread!==this.props.thread){var c=b("MercuryIDs").getUserIDFromThreadID(this.props.tab.id);a=b("MercuryIDs").getUserIDFromThreadID(a.tab.id);var d=b("WorkChatAvailabilityStatusLoader").getActionsEnforce();a&&d.unsubscribeUser(a,this);c&&(d.subscribeUser(c,this),b("WorkChatAvailabilityStatusLoader").getStoreEnforce().fetchUsers([c]))}};a.prototype.componentWillUnmount=function(){this.$4&&this.$4.disable();this.$10&&this.$10.remove();var a=b("MercuryIDs").getUserIDFromThreadID(this.props.tab.id);a&&b("WorkChatAvailabilityStatusLoader").isLoaded()&&b("WorkChatAvailabilityStatusLoader").getActionsEnforce().unsubscribeUser(a,this)};a.prototype.shouldComponentUpdate=function(a,b){var c=this.props,d=this.state;return c.hasFetchedAll!==a.hasFetchedAll||c.isFocused!==a.isFocused||c.isHovered!==a.isHovered||c.isLastGroupTab!==a.isLastGroupTab||!c.messages.equals(a.messages)||!c.tab.equals(a.tab)||!c.tabContent&&!!a.tabContent||c.tabContent&&!c.tabContent.equals(a.tabContent)||c.thread!==a.thread||c.fbid!==a.fbid||c.blockedIDs!==a.blockedIDs||c.readReceipts!==a.readReceipts||c.ignoredIds!==a.ignoredIds||d.closing!==b.closing||d.disableInput!==b.disableInput||d.isDoNotDisturb!==b.isDoNotDisturb};a.prototype.$12=function(){__p&&__p();if(b("ChatConfig").get("chat_tab_m4_header"))return;var a=this.props,c=a.tab;a=a.thread;c=c.id;if(!a)return;var d=this.refs.root&&b("ReactDOM").findDOMNode(this.refs.root);if(!d)return;a=a.unread_count;if(a!==void 0){a=!!a&&(!b("ChatBehavior").showsTabUnreadUI||b("ChatBehavior").showsTabUnreadUI());a?b("ChatTabBlinking").blinkTab(c,{getTabElem:function(){return d},isFocused:function(){return this.props.isFocused}.bind(this),isHovered:function(){return!1}}):b("ChatTabBlinking").unblinkTab(c)}};a.prototype.$17=function(){var a=this.props.tabContent&&this.props.tabContent.nullStateCTA;if(!a)return!1;if(this.props.thread&&this.props.thread.message_count===0)return!0;return b("CurrentUser").isWorkUser()&&b("gkx")("678590")?m(this.props.messages):!1};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.blockedIDs,d=a.forGameChat,e=a.hasFetchedAll,f=a.isFocused,g=a.isHovered,h=a.isLastGroupTab,k=a.messages,m=a.onLoadMoreMessages,s=a.onSelectSticker,u=a.onSendHotLike,w=a.onSendMessage,x=a.onSendPhoto,y=a.readReceipts,z=a.showContextBanner,A=a.tab,B=a.tabContent,C=a.thread,D=A.id,E=b("CurrentUser").getID();a=B&&B.composer.fileUploader;A=C&&(b("ChatConfig").getBool("dark_test_gradients")?b("convertMIGColorToFIGColor")(C.solid_color):b("convertMIGColorToFIGColor")(C.header_color));var F=B&&B.nullStateCTA,G=this.$17(),H=C&&C.participants||[],I=B&&B.threadPreviewRecipients||b("immutable").List();H=H.length>0?H:I.toArray();I=(I=this.props)!=null?(I=I.thread)!=null?I.other_user_fbid:I:I;I=I?b("MessengerParticipants.bs").getNow(b("MercuryIDs").getParticipantIDFromUserID(I)):null;var J=b("getPageIDFromThreadID")(this.props.tab.id),K=b("MessengerState.bs").isEmptyLocalThread(E,D),L=b("MessengerState.bs").isNewEmptyLocalThread(E,D),M=B&&b("WorkChatUtils").shouldForceGroupName(B)&&!B.newGroupChatName;G=C&&b("MessageRequestUtils").shouldShowComposerPendingActions(C)?b("React").createElement(b("FantaPendingActions.react"),{thread:C,threadID:D}):G&&F?b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",{className:"_2xh0"},b("React").createElement("div",{className:"_2xh4 _59w_"},b("React").createElement(b("XUISpinner.react"),{size:"small"})))},b("React").createElement(r,{threadID:D,nullStateCTA:F,pageName:I&&I.short_name})):M?b("React").createElement("div",{className:"fbNubFlyoutComposerDisabledWithoutName"},i._("Give your chat a name to start sending messages.")):B?b("React").createElement("div",{className:"fbNubFlyoutFooter"+(this.state.disableInput?" fbNubFlyoutComposerDisabled":""),"data-testid":b("FantaWebDriverIDs").COMPOSER_ROOT},b("React").createElement(b("FantaTabComposer.react"),{composer:B.composer,disableInput:this.state.disableInput,fileUploader:a,forGameChat:d,isEmptyLocalThread:K,isFocused:f&&!b("WorkChatUtils").shouldForceGroupName(B),isNewEmptyLocalThread:L,onEscape:this.$18,onKeyDown:this.$18,onKeyPress:this.$19,onSelectSticker:s,onSendHotLike:u,onSendMessage:w,onSendPhoto:x,onTab:this.$20,participants:H,ref:"composer",threadID:D,viewer:E})):null;var N;F=b("MercuryIDs").getUserIDFromThreadID(D);F&&(N=b("ShortProfiles").getNow(F));var O=N&&N.is_messenger_only;!B&&j(0,6156);I=b("React").createElement(b("FantaTabSheet.react"),{tabContent:B,threadID:D,composerComponent:this.refs.composer});a=(M=C)!=null?M.marketplace_thread_data:M;s=(L=a)!=null?L.for_sale_item:L;w=(u=a)!=null?u.buyer_fbid:u;H=(x=a)!=null?x.seller_fbid:x;var P;s&&w&&H&&(P=b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",null)},b("React").createElement(n,{buyerID:w,forSaleItem:s,renderLocation:"chat",sellerID:H})));var Q=C&&b("ChatConfig").getBool("chat_tab_has_gradients")&&(b("ChatConfig").getBool("dark_test_gradients")||C.gradient_colors&&C.gradient_colors.length>1);M=C&&b("ChatConfig").getBool("chat_tab_has_gradients")?v(C.gradient_colors,C.solid_color,b("MessengerCustomColorUtils.bs").defaultColor()):void 0;L=B&&B.isMultiCompany;u=!!B&&!!B.openSheet;var R=B&&B.joinableInterstitialData?b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",null)},b("React").createElement(o,{data:B.joinableInterstitialData,isActive:f,onClose:this.$2})):b("React").createElement("div",{className:(u?"_6vu4":"")+(t?" _6vu5":"")+(b("ChatConfig").get("chat_tab_m4_header")?" _6z9d":"")+" fbNubFlyoutInner _6vu1"},b("React").createElement(b("FantaChatHeaderContainer.react"),{blockedIDs:c,composer:B.composer,customColor:A,highlightNewMessage:B&&B.highlightNewMessage,isDoNotDisturb:this.state.isDoNotDisturb,isFocused:f,isLastGroupTab:h,isMultiCompany:L,isNewMessageTab:B&&B.isNewMessageTab,membershipParticipants:B.membershipParticipants,onClose:this.$2,pageIndicatorDescription:B.pageIndicatorDescription,participants:B.participants,thread:C,threadHref:B&&B.threadHref,threadID:D,uri:B.uri,viewer:E}),b("React").createElement("div",{className:"_1ia _2sz2",ref:function(a){this.$5=a}.bind(this),style:M},I,b("React").createElement(b("FantaConversationScroller.react"),{forGameChat:d,hasFetchedAll:e,isFocused:f,isEmptyLocalThread:K,messages:k,onFocus:function(){return this.refs.composer&&this.refs.composer.focusInput()}.bind(this),onLoadMoreMessages:m,readReceipts:y,showContextBanner:z,thread:C,threadID:D,viewer:E,jumpToMessage:B.jumpToMessage}),b("React").createElement("div",{className:"_2hc2"},b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",null)},F?b("React").createElement(p,{isVisible:!0,otherUserID:F,threadID:D}):b("React").createElement(p,{isVisible:!0,threadID:D}))),b("React").createElement("div",{className:"_4g6x"},b("React").createElement("div",{className:"_4g6y"},b("React").createElement("div",{className:"_4g6z _4g71"},i._("Drag Link\/Files Here")),b("React").createElement("div",{className:"_4g6z _4g6- _4g6_"},i._("Drop Files Here")),b("React").createElement("div",{className:"_4g6z _4g6- _4g70"},i._("Drop Link Here")))),J?b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",null)},b("React").createElement(q,{originalElement:G,pageID:J,playLinkClassName:"_2xh6 _2h_r",showGameImage:!0,threadFBID:(a=this.props)!=null?(a=a.thread)!=null?a.thread_fbid:a:a,threadID:D})):G,b("React").createElement(b("FantaDragAndDrop.react"),{composer:B.composer,threadID:D}),P));return b("React").createElement(l,{subscribeToIDs:[E]},function(a){return b("React").createElement("div",{className:b("joinClasses")((this.state.closing?"_2suj":"")+" _3_9e _s0f _50mz _50m_"+(C&&!O&&b("MessengerParticipantUtils.bs").findIntersection(E,a,C).length>0&&!this.state.isDoNotDisturb?" _4-0b":"")+(this.state.isDoNotDisturb?" _1oh2":"")+" fbNub _50-v"+(f?" focusedTab":"")+(g?" hoveredTab":"")+" opened _27_3"+(b("ChatConfig").get("single_line_composer")?" _68h9":"")+((b("gkx")("692188")?Q:!1)?" _3hx-":"")+((b("gkx")("692188")?!Q:!1)?" _3fr9":""),"fantaTabMain-"+D),"data-ft":b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.CHAT_FLYOUT),onBlur:this.$21,onFocus:this.$22,onKeyDown:this.$18,onKeyPress:this.$19,onMouseEnter:this.$23,onMouseLeave:this.$24,ref:"root"},b("React").createElement("div",{className:"fbNubFlyout fbDockChatTabFlyout uiContextualLayerParent",role:"complementary"},b("React").createElement("div",{className:"fbNubFlyoutOuter"},R)))}.bind(this))};a.prototype.$15=function(){var a=b("MercuryIDs").getUserIDFromThreadID(this.props.tab.id);a&&b("gkx")("678573")&&b("promiseDone")(b("WorkChatAvailabilityStatusLoader").load(),function(b){var c=b.store;b._;this.$10=c.addListener(function(){this.setState({isDoNotDisturb:c.getIsDoNotDisturb(a)})}.bind(this))}.bind(this))};a.prototype.$25=function(a){b("FantaDispatcher").isDispatching()||b("FantaTabActions").blurTab(this.props.tab.id),this.$9&&(b("clearTimeout")(this.$9),this.$9=null),b("setTimeout")(function(){b("FantaTabActions").unhoveredTab(a)})};a.prototype.$16=function(){var a=b("getPageIDFromThreadID")(this.props.tab.id);a&&b("MessengerBotMenuDataFetcher").getHasPageSetting(a,function(a){this.setState({disableInput:a})}.bind(this),function(){this.setState({disableInput:!1})}.bind(this),b("MNCommercePageSetting").COMPOSER_INPUT_DISABLED)};a.prototype.$11=function(){__p&&__p();if(b("WorkFileUploadsGating").canUploadFiles&&!this.$4){var a=b("ReactDOM").findDOMNode(this.$5);if(a){a=new(b("DragDropTarget"))(a);this.$4=a;a.setOnFilesDropCallback(this.$26);a.setOnURLDropCallback(this.$27);a.enable()}}};a.prototype.$3=function(a,c){a||(c?b("FantaTabActions").focusPreviousTab():b("FantaTabActions").focusNextTab())};a.prototype.$29=function(){var a=this.props.tab.id;b("Bootloader").loadModules(["MessengerShareFilePreviewFunnelLogger"],function(b){return b.endFunnel(a)},"FantaTabMain.react")};a.prototype.$28=function(){return this.$32()||this.$33()};a.prototype.$32=function(){var a,b=this.props.tabContent;a=((a=b)!=null?(a=a.composer)!=null?(a=a.fileUploader)!=null?a.uploadedFiles:a:a:a)||{size:0};b=((b=b)!=null?(b=b.composer)!=null?(b=b.fileUploader)!=null?b.uploadingFiles:b:b:b)||{size:0};return a.size>0||b.size>0};a.prototype.$33=function(){var a=this.props.tabContent;a=(a=a)!=null?(a=a.composer)!=null?a.sharePreview:a:a;return!!(a&&a.params&&a.type)};a.prototype.$34=function(a){var c=this.props.tab,d=b("ReactDOM").findDOMNode(this.refs.root);this.$1=b("setTimeout")(function(){return a?b("FantaTabActions").closeAndTabNext(c.id):b("FantaTabActions").closeTab(c.id)},1.2*Number("200ms".replace(s,"")));if(d)var e=b("Event").listen(d,b("getVendorPrefixedEventName")("animationend"),function(d){d.animationName==="closeChatTab"&&(a?b("FantaTabActions").closeAndTabNext(c.id):b("FantaTabActions").closeTab(c.id),b("clearTimeout")(this.$1),e.remove())}.bind(this));this.$31();this.setState({closing:!0})};a.prototype.$30=function(a){var c=this.props.tab,d=c.id;b("FantaTabActions").blurTab(d);c=i._("Are you sure you want to close this chat window?");var e=i._("You haven't sent your message.");b("SimpleXUIDialog").showConfirm(c,e,function(c){c?(this.$29(),a?b("FantaTabActions").closeAndTabNext(d):b("FantaTabActions").closeTab(d)):b("FantaTabActions").focusTab(d)}.bind(this),{autofocusConfirm:!0,useReactFocusBehavior:!0})};a.prototype.$14=function(){this.$8=Math.floor(Date.now()/1e3)};a.prototype.$31=function(){var a=this.props,c=a.thread,d=a.tab,e=c?c.other_user_fbid:null,f=Math.floor(Date.now()/1e3),g=this.$8;c&&e&&!b("FBIDCheck").isUser_deprecated(e)&&b("Bootloader").loadModules(["PagesLogger","PagesLoggerEventEnum","PagesLoggerEventTargetEnum","PagesEventObserver","PagesEventType"],function(a,b,h,i,j){a.log(e,b.CLICK,h.MESSAGE_FANTA_TAB_CLOSE,"",["pages_surface_team"],{open_tab_timestamp:g,close_tab_timestamp:f,last_message_timestamp:c.last_message_timestamp,message_count:c.message_count,snippet_sender:c.snippet_sender,participants:c.participants,entrypoint:d.entryPoint}),i.notify(j.MESSAGES_FANTA_TAB_CLOSE,e,{open_tab_timestamp:g,close_tab_timestamp:f,last_message_timestamp:c.last_message_timestamp,message_count:c.message_count,snippet_sender:c.snippet_sender,participants:c.participants,entrypoint:d.entryPoint})},"FantaTabMain.react")};a.prototype.$13=function(a){__p&&__p();if(!b("MercuryIDs").isValidThreadID(a))return;b("Bootloader").loadModules(["GroupChatMessageBlockAlert","GroupChatMessageIgnoreAlert","MercuryIgnoredBlockedParticipants.bs","MercuryThreadActions"],function(c,d,e,f){__p&&__p();var g=f.get();b("MessengerState.bs").getThreadMeta(b("CurrentUser").getID(),a,function(f){var h=this.props,i=h.fbid,j=h.ignoredIds;b("MessengerState.bs").compute(i,function(h){h=h.blocked_ids;e.isPresentInGroupThread(i,h,f)?c.show(e.participantsInGroupThread(i,h,f),function(){b("FantaTabActions").focusTab(a)},function(){b("FantaTabActions").closeTab(a),b("MessengerState.bs").isEmptyLocalThread(b("CurrentUser").getID(),a)||g.leaveGroup(a)}):b("MessengerParticipantUtils.bs").areParticipantsInGroupThread(i,j,f)&&f.folder==="inbox"&&d.show(b("MessengerParticipantUtils.bs").participantsInGroupThread(i,j,f),b("MercuryIDs").getThreadFBIDFromThreadID(a),function(){b("FantaTabActions").focusTab(a)},function(){b("FantaTabActions").closeTab(a),b("Bootloader").loadModules(["IgnoreMessagesTypedLogger","IgnoreMessagesLoggingEvent","IgnoreMessagesPlatforms"],function(c,d,e){g.changeFolder(a,b("MessagingTagConstants").other),new c().setEvent(d.IGNORE_CONFIRMED).setThreadID(b("MercuryIDs").getThreadFBIDFromThreadID(a)).setPlatform(e.CHAT_TABS).log()},"FantaTabMain.react")})})}.bind(this))}.bind(this),"FantaTabMain.react")};a.propTypes={hasFetchedAll:c.bool.isRequired,isFocused:c.bool.isRequired,isHovered:c.bool.isRequired,isLastGroupTab:c.bool.isRequired,messages:c.object,onLoadMoreMessages:c.func.isRequired,onSelectSticker:c.func.isRequired,onSendHotLike:c.func.isRequired,onSendMessage:c.func.isRequired,onSendPhoto:c.func.isRequired,raisedTabCount:c.number,showContextBanner:c.bool,tab:c.object.isRequired,tabContent:c.object,thread:c.object,forGameChat:c.bool.isRequired};e.exports=a}),null);
__d("FantaTabMainLoader.react",["Bootloader","FantaAppStore","FantaGetMessageActions","FantaMessageActions","FantaTabMain.react","MercuryThreadActions","MessageRequestUtils","MessagingTag","MessengerState.bs","React","TimeSlice","emptyFunction","immutable","requestIdleCallback","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;var h=function(a){__p&&__p();b("FantaAppStore").addReducers(a);a=b("FantaAppStore").getState();a=(a=a)!=null?(a=a.mercury)!=null?a.tabContents:a:a;if(a){var c=a.reduce(function(a,b){b=b.thread;b&&a.push(b);return a},[]);b("setImmediate")(function(){return b("FantaGetMessageActions").threadsUpdated(c)})}h=b("emptyFunction")};d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$1=function(){var a=this.props.tab;b("FantaGetMessageActions").fetchMoreMessages(a.id)}.bind(this),this.$2=function(a,c){var d=this.props.tab;b("FantaMessageActions").sendSticker(d.id,a,c)}.bind(this),this.$3=function(a,c,d,e){var f=this.props.tab;b("FantaMessageActions").sendHotLike(f.id,a,c,d,e)}.bind(this),this.$4=function(a,c,d){var e=this.props.tabContent.thread,f=this.props.tab;e&&b("MessageRequestUtils").isMessageRequest(e)&&b("MercuryThreadActions").get().changeFolder(e.thread_id,b("MessagingTag").INBOX);b("FantaMessageActions").sendMessage(f.id,a,c,d)}.bind(this),this.$5=function(a,c){var d=this.props.tab;b("FantaMessageActions").sendPhoto(d.id,a,c)}.bind(this),c}a.prototype.shouldComponentUpdate=function(a){var b=this.props;return b.isFocused!==a.isFocused||b.isHovered!==a.isHovered||b.isLastTabOfType!==a.isLastTabOfType||b.messengerState!==a.messengerState||!b.tab.equals(a.tab)||!b.tabContent.equals(a.tabContent)};a.prototype.componentDidMount=function(){var a=function(){b("Bootloader").loadModules(["FantaReducersTabSheets"],h,"FantaTabMainLoader.react")};b("TimeSlice").guard(function(){b("requestIdleCallback")(a)},"additional request not needed for initial display",{propagationType:b("TimeSlice").PropagationType.ORPHAN})()};a.prototype.render=function(){var a=this.props,c=a.isFocused,d=a.isHovered,e=a.isLastTabOfType,f=a.messengerState,g=a.raisedTabCount,h=a.tab,i=a.tabContent;a=a.forGameChat;var j=i.hasFetchedAll,k=i.showContextBanner,l=i.thread,m=i.threadPreviewID,n=i.messages;m=m?h.id+"-"+m:h.id;if(!i)return b("React").createElement("div",{key:"noContent-"+m});n||(n=b("immutable").List());return b("React").createElement(b("FantaTabMain.react"),{blockedIDs:b("MessengerState.bs").blockedIds(f),fbid:b("MessengerState.bs").fbid(f),forGameChat:a,hasFetchedAll:j,ignoredIds:b("MessengerState.bs").ignoredIds(f),isFocused:c,isHovered:d,isLastGroupTab:e,key:m,messages:n,onLoadMoreMessages:this.$1,onSelectSticker:this.$2,onSendHotLike:this.$3,onSendMessage:this.$4,onSendPhoto:this.$5,raisedTabCount:g,readReceipts:b("MessengerState.bs").readReceiptsPerThread(f),showContextBanner:k,tab:h,tabContent:i,thread:l})};a.propTypes={isFocused:c.bool.isRequired,isHovered:c.bool.isRequired,isLastTabOfType:c.bool.isRequired,messengerState:c.array,raisedTabCount:c.number,tab:c.object.isRequired,tabContent:c.object};e.exports=a}),null);
__d("XUIBadgeReact.bs",["ReasonReact.bs","XUIBadge.react","bs_js_null_undefined"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a){if(a!==void 0)if(a)return"regular";else return"special"}function a(a,c,d,e,f){return b("ReasonReact.bs").wrapJsForReason(b("XUIBadge.react"),{className:b("bs_js_null_undefined").fromOption(c),count:b("bs_js_null_undefined").fromOption(d),maxcount:b("bs_js_null_undefined").fromOption(e),type:b("bs_js_null_undefined").fromOption(g(a))},f)}f.stringOfBadgeType=g;f.make=a}),null);
__d("FantaM4HeaderMinimized.bs",["cx","fbt","cssVar","bs_block","bs_curry","React","bs_belt_Set","bs_belt_Option","ReasonReact.bs","bs_js_primitive","FantaM4Header.bs","ParticipantId.bs","XUIBadgeReact.bs","ChatThreadName.bs","ChatDetailStack.bs","FantaCloseButton.bs","FantaProfilePresence.bs","MessengerParticipantUtils.bs","MessengerPresenceProvider.bs"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j=b("ReasonReact.bs").reducerComponentWithRetainedProps("FantaM4HeaderMinimized");function k(a,c,d,e,f,g,i,k,l){__p&&__p();return[j[0],j[1],j[2],j[3],j[4],function(a){var c=a[1];if(!a[0][2][0]&&c[2][0]){b("bs_curry")._1(c[3],0);setTimeout(function(){return b("bs_curry")._1(c[3],1)},1e3);return 0}else return 0},j[6],j[7],function(j){__p&&__p();var l=b("FantaM4Header.bs").getProfileImages(f,e,g),m=f!==void 0?b("bs_js_primitive").valFromOption(f).unread_count:0,n=b("FantaM4Header.bs").getTooltip(f);if(f!==void 0){var o=b("bs_js_primitive").valFromOption(f).header_color;o=o==null?"#0084ff":o}else o="#0084ff";var p=a&&j[1][0];p=p&&o!==void 0?[o,"_69pt _2mgn _6d6l"]:["","_69pt _6d6l"];var q=p[0];if(f!==void 0){o=b("bs_js_primitive").valFromOption(f);o=[o.thread_fbid,o.is_canonical]}else o=[null,!0];var r=o[1],s=o[0];o=b("bs_belt_Option").map(f,function(a){return b("bs_belt_Set").fromArray(a.participants,[b("ParticipantId.bs").cmp])});o=i?null:b("ReasonReact.bs").element(void 0,void 0,b("bs_curry")._3(b("MessengerPresenceProvider.bs").make(o),void 0,void 0,function(a){return b("ReasonReact.bs").element(void 0,void 0,b("FantaProfilePresence.bs").make(l,20,f!==void 0?b("MessengerParticipantUtils.bs").areParticipantsInThread(g,a,b("bs_js_primitive").valFromOption(f))&&!k:!1,!0,"",n,q,!1,void 0,r,s==null?void 0:b("bs_js_primitive").some(s),e,[]))}));var t=i?h._("New Message"):b("ReasonReact.bs").element(void 0,void 0,b("ChatThreadName.bs").make(f,"",n,g,"_2mgq",i,[]));j=m>0&&!(a&&j[1][0]);return b("React").createElement("div",{className:p[1],style:{backgroundColor:q},onClick:d},b("React").createElement("div",{className:"_66n2"},o,b("React").createElement("div",{className:"_66n3"},b("ReasonReact.bs").element(void 0,void 0,b("ChatDetailStack.bs").make(t,null,[])),j?b("ReasonReact.bs").element(void 0,void 0,b("XUIBadgeReact.bs").make(0,"_429n",m,99,[])):null)),b("ReasonReact.bs").element(void 0,void 0,b("FantaCloseButton.bs").make(c,!1,[])))},function(){return[!1]},[a],function(c,a){if(c)return b("bs_block").__(0,[[!1]]);else return b("bs_block").__(0,[[!0]])},j[12]]}a=b("ReasonReact.bs").wrapReasonForJs(j,function(a){return k(a.highlightNewMessage,a.onClose,a.onHeaderToggle,b("bs_js_primitive").nullable_to_opt(a.participants),b("bs_js_primitive").nullable_to_opt(a.thread),a.viewer,a.isNewMessageTab,a.isMessengerOnlyUser,[])});c=20;d=1e3;f.component=j;f.small_profile_image_size=c;f.blink_threshold_ms=d;f.make=k;f.jsComponent=a}),null);
__d("FantaTabMinimized.react",["cx","fbt","Bootloader","ChatBehavior","ChatConfig","ChatTabBlinking","ChatTabHeaderContainer.react","CurrentUser","FantaAvailableStatus","FantaM4HeaderMinimized.bs","FantaTabActions","MercuryIDs","React","ReactDOM","ShortProfiles","SimpleXUIDialog","emptyFunction"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i,j=b("FantaM4HeaderMinimized.bs").jsComponent,k=b("ChatConfig").get("chat_tab_m4_header");c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={closing:!1},this.$5=function(a){a=this.props;var c=a.tab;a=a.tabContent;!a||a&&a.composer.text.length===0&&!this.$7()?(this.$8(),b("FantaTabActions").closeTab(c.id)):this.$9()}.bind(this),this.$6=function(a){var c=a.target;c&&c.classList&&!c.classList.contains("button")&&(a.stopPropagation(),b("FantaTabActions").unminimizeTab(this.props.tab.id),b("FantaTabActions").focusTab(this.props.tab.id))}.bind(this),c}a.prototype.componentDidMount=function(){this.$3()};a.prototype.componentDidUpdate=function(){this.$3()};a.prototype.shouldComponentUpdate=function(a){var b=this.props;return!b.tab.equals(a.tab)||!b.tabContent&&!!a.tabContent||!!b.tabContent&&!b.tabContent.equals(a.tabContent)};a.prototype.$3=function(){__p&&__p();if(k)return;var a=this.props,c=a.tab;a=a.tabContent;c=c.id;if(!a)return;a=a.thread;if(!a)return;var d=this.refs.root&&b("ReactDOM").findDOMNode(this.refs.root);if(!d)return;a=a.unread_count;if(a!==void 0){a=!!a&&(!b("ChatBehavior").showsTabUnreadUI||b("ChatBehavior").showsTabUnreadUI());a?b("ChatTabBlinking").blinkTab(c,{getTabElem:function(){return d},isFocused:function(){return!1},isHovered:function(){return!1}}):b("ChatTabBlinking").unblinkTab(c)}};a.prototype.$4=function(){var a=this.props.tabContent,c=a&&a.thread,d=a&&a.thread&&a.thread.header_color,e=d?{color:d}:null,f=b("CurrentUser").getID();if(k){var g=a?b("MercuryIDs").getUserIDFromThreadID(a.id):null;g=g?b("ShortProfiles").getNow(g):null;g=g&&g.is_messenger_only;return b("React").createElement("div",{className:"clearfix titlebar"},b("React").createElement(j,{highlightNewMessage:a&&a.highlightNewMessage,isNewMessageTab:a&&a.isNewMessageTab,onClose:this.$5,onHeaderToggle:this.$6,isMessengerOnlyUser:g,participants:a&&a.participants,thread:c,viewer:f}))}return b("React").createElement("div",{className:(this.state.closing?"_2suj":"")+" clearfix fbNubFlyoutTitlebar titlebar"+(d?" _1m34":""),style:e},b("React").createElement(b("ChatTabHeaderContainer.react"),{attachmentsShelf:document.createElement("div"),hasBlockedMessages:!1,href:a&&a.threadHref,isActive:!1,isNewMessageTab:!!(a&&a.isNewMessageTab),isRaised:!1,isTyping:!1,membershipParticipants:a&&a.membershipParticipants,onClick:this.$6,onCloseClick:this.$5,onRTCNuxCloseButtonClick:b("emptyFunction"),participants:a&&a.participants,pageUnsubscribeStatus:!1,rtcNuxShown:!1,sheetController:{},showMessengerReportNux:!1,showAddFriend:b("emptyFunction"),thread:c,threadID:this.props.tab.id,viewer:f}))};a.prototype.render=function(){var a=this.props,c=a.tab;a=a.tabContent;c=c.id;a=a&&!!a.thread&&b("FantaAvailableStatus").isAvailable(a.thread,c);return b("React").createElement("div",{className:"_4cd8 _50mz _50m_ fbNub _50-v"+(a?" _4-0b":"")+" _27_3",ref:"root"},this.$4())};a.prototype.$8=function(){var a=this.props.tab.id;b("Bootloader").loadModules(["MessengerShareFilePreviewFunnelLogger"],function(b){return b.endFunnel(a)},"FantaTabMinimized.react")};a.prototype.$7=function(){return this.$10()||this.$11()};a.prototype.$10=function(){var a,b=this.props.tabContent;a=((a=b)!=null?(a=a.composer)!=null?(a=a.fileUploader)!=null?a.uploadedFiles:a:a:a)||{size:0};b=((b=b)!=null?(b=b.composer)!=null?(b=b.fileUploader)!=null?b.uploadingFiles:b:b:b)||{size:0};return a.size>0||b.size>0};a.prototype.$11=function(){var a=this.props.tabContent;a=(a=a)!=null?(a=a.composer)!=null?a.sharePreview:a:a;return!!(a&&a.params&&a.type)};a.prototype.$9=function(){var a=this.props.tab,c=h._("Are you sure you want to close this chat window?");b("FantaTabActions").blurTab(a.id);var d=h._("You haven't sent your message.");b("SimpleXUIDialog").showConfirm(c,d,function(c){c?b("FantaTabActions").closeTab(a.id):b("FantaTabActions").focusTab(a.id)},{autofocusConfirm:!0,useReactFocusBehavior:!0})};a.propTypes={tab:c.object.isRequired,tabContent:c.object};e.exports=a}),null);
__d("FantaMercuryTabsWithMain.react",["Bootloader","CurrentUser","FantaAppStore","FantaCookieUtil","FantaMercuryTabOverflowBootloader.react","FantaTabActions","FantaTabGroup.react","FantaTabMainLoader.react","FantaTabMinimized.react","FluxContainer","LazyComponent.react","LoadOnRender.react","MercuryIDs","MessengerState.bs","PresenceState","React"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("MessengerState.bs").jsComponent,i=function(a){b("Bootloader").loadModules(["MessengerReasonDialogContainerReact.bs"],function(b){b=b.jsComponent;return a(b)},"FantaMercuryTabsWithMain.react")};g=babelHelpers.inherits(a,b("React").PureComponent);g&&g.prototype;a.getStores=function(){return[b("FantaAppStore")]};a.calculateState=function(){return{tabGroup:b("FantaAppStore").getState().tabGroup,tabContents:b("FantaAppStore").getState().mercury.tabContents}};a.prototype.componentDidMount=function(){this.props.loadDataOnMount&&b("FantaTabActions").loadFromData(b("FantaCookieUtil").convertCookieData(b("PresenceState").get()))};a.prototype.render=function(){return b("React").createElement(h,{fbid:b("CurrentUser").getID()},function(a){return[b("React").createElement(b("FantaTabGroup.react"),{key:"tabgroup",messengerState:a,MainComponent:b("FantaTabMainLoader.react"),MinimizedComponent:b("FantaTabMinimized.react"),OverflowComponent:b("FantaMercuryTabOverflowBootloader.react"),tabGroup:this.state.tabGroup,tabContents:this.state.tabContents,isLastOfTypeChecker:this.$1}),b("React").createElement(b("LoadOnRender.react"),{key:"dialog",component:b("React").createElement(b("LazyComponent.react"),null),loader:i,placeholder:b("React").createElement("span",null)})]}.bind(this))};a.prototype.$1=function(a){return b("MercuryIDs").isGroupChat(a.id)};function a(){g.apply(this,arguments)}e.exports=b("FluxContainer").create(a)}),null);
__d("FantaTabsReactApp",["ChatPerfInstrumentation","FantaMercuryTabsWithMain.react","FantaTabsAppBase","React","ReactDOM","UserActivity","gkx","setImmediate"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=500,i;g=babelHelpers.inherits(a,b("FantaTabsAppBase"));g&&g.prototype;a.prototype.initializeFantaData=function(a){__p&&__p();d(["FantaAppStore","FantaCookieUtil","FantaGetMessageActions","FantaTabActions","MercuryThreadInformer","PresenceState"],function(c,d,e,f,g,j){__p&&__p();f.loadFromData(d.convertCookieData(j.get(),null,a)),j.registerStateLoader(function(b){f.loadFromData(d.convertCookieData(b,c.getState().tabGroup,a))}),j.registerStateStorer(function(a){if(!b("UserActivity").isOnTab()&&!b("UserActivity").isActive(h)&&!b("gkx")("678595"))return a;var e=c.getState().tabGroup;if(!i||i&&!i.equals(e)){i=e;return d.createCookieData(e,a)}else return a}),g.get().subscribe("threads-updated",function(a,c){Object.keys(c).forEach(function(a){b("setImmediate")(function(){e.refreshThread(a)})})}),b("ChatPerfInstrumentation").logInitData()})};a.prototype.initializeFantaUI=function(){__p&&__p();d(["FantaAppStore","FantaMercuryThreadEventsBootloaded","FantaMessageActions","FantaTabActions","FantaTabViewportManager","FBRTCMessageHandler","MercuryBrowserAlerts"],function(a,c,d,e,f,g,h){__p&&__p();g.init();h.init();b("ReactDOM").render(this.getViewComponent(),this.tabsElem);c.onMessagesReceived(function(a,c){b("setImmediate")(function(){d.receivedNewMessage(a,c)})});f.init(this.tabsElem);b("ChatPerfInstrumentation").logInitUI();e=a.getState().tabGroup.tabs;e.toArray().length===0&&b("ChatPerfInstrumentation").logDisplayDone()}.bind(this))};a.prototype.getViewComponent=function(){return b("React").createElement(b("FantaMercuryTabsWithMain.react"),{loadDataOnMount:!1})};function a(){g.apply(this,arguments)}e.exports=new a()}),null);